<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-10-06 Thu 10:20 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Windows</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Julian Orchard &lt;git@julianorchard.co.uk&gt;" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet"
                        href="../src/org-style.css"
                        type="text/css"/>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="preamble" class="status">
<nav>
                           <ul>
                           <li>
                           <a class="link" href="/">Home</a>
                           </li>
                           <li>
                           <a class="link" href="/about/">About</a>
                           </li>
                           <li>
                           <a class="link" href="/posts/">Posts</a>
                           </li>
                           </ul>
                           </nav>
</div>
<div id="content">
<h1 class="title">Windows</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgd466bdf">About</a></li>
<li><a href="#orgd4516e5">DOSBatch</a>
<ul>
<li><a href="#orgafc34cb">Prompt (<code>cmdrc.bat</code>)</a></li>
<li><a href="#org21a6065">Windows Path Stuff</a></li>
<li><a href="#org1eb157d">Quick Navigation with CMD</a></li>
<li><a href="#org44e740a">Ping-Based Scripts</a></li>
<li><a href="#org859f671">Very Small and/or Unix-y</a></li>
</ul>
</li>
<li><a href="#orgbb5eb0f">Powershell</a>
<ul>
<li><a href="#orgde466b5">No Admin Powershell</a></li>
<li><a href="#org97e55f7">Config</a></li>
<li><a href="#orgece09be">'Email' Scripts</a>
<ul>
<li><a href="#orgce805fb"><span class="done DONE">DONE</span> Should use argument flags instead of by order</a></li>
<li><a href="#org53c96a4"><span class="todo TODO">TODO</span> General cleanup of this script</a></li>
<li><a href="#org32830d6"><span class="todo TODO">TODO</span> Improve Param()</a></li>
</ul>
</li>
<li><a href="#org70774b5">Fonts</a>
<ul>
<li><a href="#org88f4c6d"><span class="todo TODO">TODO</span> Refactor this at some point</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgf80829c">AutoHotkey</a>
<ul>
<li><a href="#org53df033">About</a></li>
<li><a href="#orgf8f1714">Essentials</a></li>
<li><a href="#org2a77206">Snipping Tools</a></li>
<li><a href="#orgdddf52e">Lines and Symbols</a></li>
<li><a href="#org33f7811">Instagram Hashtags</a></li>
<li><a href="#org88c5c0f">Timestamps</a></li>
<li><a href="#org1bea9e7">Email Sign-Offs</a></li>
<li><a href="#orgbf8f42e">LinkedIn</a></li>
<li><a href="#org6152e78">Lipsum</a></li>
<li><a href="#org8c20920">Taskbar</a></li>
<li><a href="#org5df488f">Custom Start + E</a></li>
<li><a href="#org5516d7c">Screen Refresher and Keyboard Locker</a></li>
<li><a href="#orged71511">Printing</a></li>
<li><a href="#org796001a">Fun Stuff</a></li>
</ul>
</li>
<li><a href="#orgaf7bf3b">Cygwin</a>
<ul>
<li><a href="#orgf8e525c">About</a></li>
<li><a href="#org058c9db">Bashrc</a></li>
<li><a href="#org0815e32">Minttyrc</a></li>
<li><a href="#org45c1d21">Tidy Files</a></li>
<li><a href="#org76e1a5c">Hack</a></li>
<li><a href="#orgfad02d2">MAMP Fix</a></li>
</ul>
</li>
<li><a href="#orgce28282">Wallpaper</a>
<ul>
<li><a href="#org2af5c00">About</a></li>
<li><a href="#orgda2a7ba">Set The Wallpaper</a></li>
<li><a href="#org572721d">Wallpaper Choice</a></li>
<li><a href="#orgeaa19c0">Sort Wallpaper Files</a></li>
</ul>
</li>
<li><a href="#orgd4ba028">Hours</a>
<ul>
<li><a href="#orgdd041f6">About</a></li>
<li><a href="#org27ca5e7">Argument Parsing</a></li>
<li><a href="#orgc0ed426">Clocking In / Out</a></li>
<li><a href="#orgc441d88">Checking Times</a></li>
</ul>
</li>
<li><a href="#org5a9aad9">Notes</a></li>
</ul>
</div>
</div>
<p>
A literate Windows 10 configuration, set up in the folder <code>C:/cmd</code>.
</p>

<div id="outline-container-orgd466bdf" class="outline-2">
<h2 id="orgd466bdf">About</h2>
<div class="outline-text-2" id="text-orgd466bdf">
<p>
This is a document explaining some of my (previously sprawling and unweildy) Windows 10 configuration files, that I store in <code>c:\cmd\</code>.
</p>

<p>
In this way, I'll be able to explain what's going on with some of the methods I've used. I don't have administrator level access on my work machine, for example, so often use portable .exe's and other workarounds to get certain technologies working! Some of them are good, and some of them are ugly, but all of them, now, will be explained&#x2026;
</p>
</div>
</div>

<div id="outline-container-orgd4516e5" class="outline-2">
<h2 id="orgd4516e5">DOSBatch</h2>
<div class="outline-text-2" id="text-orgd4516e5">
</div>
<div id="outline-container-orgafc34cb" class="outline-3">
<h3 id="orgafc34cb">Prompt (<code>cmdrc.bat</code>)</h3>
<div class="outline-text-3" id="text-orgafc34cb">
<p>
This is one of the first files I started to work on when I began my Windows configuration. Where I'd previously used <code>.bashrc</code> on *nix systems, I was shocked to find that this was as close as you could get with Windows CMD.
</p>

<div class="org-src-container">
<pre class="src src-bat">@<span style="color: #8f0075;">echo</span> off
</pre>
</div>

<p>
These get and set the components of the prompt. It looks something like this, when finished:
</p>

<div class="org-src-container">
<pre class="src src-bat"><span style="color: #8f0075;">Time</span>: 16:20:20     Git: hello@julianorchard.co.uk     Hours: 14/37.5
  C:\Users\jorchard &gt; <span style="color: #8f0075;">echo</span> <span style="color: #2544bb;">"hello!"</span>
</pre>
</div>

<p>
So the elements we need to get are:
</p>
<ul class="org-ul">
<li>The time (which is just built in to the CMD prompts abilities)</li>
<li>The git email address (which is the first part)</li>
<li><del>The number of hours I have done for the week ([BROKEN LINK: link:windows.org#hours])</del> It used to have the number of hours to do in a week, which drew from my <code>\hours\</code> scripts, but since I stopped needing that I've removed it. The prompt that included that was like this:</li>
</ul>

<div class="org-src-container">
<pre class="src src-bat"><span style="color: #8f0075;">set</span> <span style="color: #00538b;">PROMPT</span>=$STime:$S$T$H$H$H$S$S$S$S$S$SGit:$S%<span style="color: #00538b;">email</span>%$S$S$S$S$S$SHours:$S%<span style="color: #00538b;">hours</span>%/37.5$_$S$S$P$S$G$S
</pre>
</div>

<p>
The current version is below: 
</p>

<div class="org-src-container">
<pre class="src src-bat"><span style="color: #5317ac;">for</span> /<span style="color: #005a5f;">f</span> <span style="color: #2544bb;">"tokens=* usebackq"</span> %%<span style="color: #00538b;">f</span> <span style="color: #5317ac;">in</span> (`git config user.email`) <span style="color: #5317ac;">do</span> (
  <span style="color: #8f0075;">set</span> <span style="color: #00538b;">email</span>=%%<span style="color: #00538b;">f</span>
)
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">/</span><span style="color: #00538b;">p</span> hours=&lt;C:\<span style="color: #5317ac;">cmd</span>\hours\log\cmdrc.txt
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">PROMPT</span>=$STime:$S$T$H$H$H$S$S$S$S$S$SGit:$S%<span style="color: #00538b;">email</span>%$_$S$S$P$S$G$S
</pre>
</div>

<p>
Finally we start in the home directory, rather than the location of this file, and run CMD.exe.
</p>

<div class="org-src-container">
<pre class="src src-bat"><span style="color: #8f0075;">cd</span> %<span style="color: #00538b;">homepath</span>%
<span style="color: #5317ac;">CMD</span>
</pre>
</div>

<p>
If we want to refresh the prompt at any point, we can use the following script to do so:
</p>

<div class="org-src-container">
<pre class="src src-bat">@<span style="color: #8f0075;">echo</span> off
<span style="color: #5317ac;">for</span> /<span style="color: #005a5f;">f</span> <span style="color: #2544bb;">"tokens=* usebackq"</span> %%<span style="color: #00538b;">f</span> <span style="color: #5317ac;">in</span> (`git config user.email`) <span style="color: #5317ac;">do</span> (
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">email</span>=%%<span style="color: #00538b;">f</span>
)
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">/</span><span style="color: #00538b;">p</span> hours=&lt;C:\<span style="color: #5317ac;">cmd</span>\hours\log\cmdrc.txt
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">PROMPT</span>=$STime:$S$T$H$H$H$S$S$S$S$S$SGit:$S%<span style="color: #00538b;">email</span>%$_$S$S$P$S$G$S
</pre>
</div>

<p>
Which is, of course, the exact same as the <code>cmdrc.bat</code> file, but we don't need to change the directory or start the CMD process.
</p>
</div>
</div>

<div id="outline-container-org21a6065" class="outline-3">
<h3 id="org21a6065">Windows Path Stuff</h3>
<div class="outline-text-3" id="text-org21a6065">
<p>
Some of the content in here is redundant, some of it is a little outdated, but all of it has been useful at some point or another with regards to manipulating the Windows 10 <code>PATH</code> environment. 
</p>

<p>
Possibly the most useful script here is one created as part of the <a href="https://chocolatey.org/">Chocolatey</a> package manager for Windows (that sadly never used before). It refeshes your <code>PATH</code> (link to the original <a href="https://github.com/chocolatey/choco/blob/master/src/chocolatey.resources/redirects/RefreshEnv.cmd">here</a>, and the <a href="https://github.com/chocolatey/choco/">repo is here</a>):
</p>

<div class="org-src-container">
<pre class="src src-bat">
@<span style="color: #8f0075;">echo</span> off

<span style="color: #505050;">::  Author:     https://github.com/chocolatey/choco/</span>
<span style="color: #505050;">::              https://github.com/chocolatey/choco/blob/master/</span>
<span style="color: #505050;">::              src/chocolatey.resources/redirects/RefreshEnv.cmd</span>

<span style="color: #8f0075;">echo</span> Run this with <span style="color: #5317ac;">call</span> <span style="color: #0000c0;">refresh.bat</span> <span style="color: #5317ac;">for</span> optimum results!!!
<span style="color: #8f0075;">echo</span> | <span style="color: #8f0075;">set</span> <span style="color: #00538b;">/</span><span style="color: #00538b;">p</span> dummy=<span style="color: #2544bb;">"Refreshing environment variables from registry for cmd.exe. Please wait..."</span>
<span style="color: #5317ac;">goto</span> <span style="color: #0000c0;">main</span>
<span style="font-weight: bold;">:SetFromReg</span>
    <span style="color: #2544bb;">"%WinDir%\System32\Reg"</span> QUERY <span style="color: #2544bb;">"%~1"</span> /<span style="color: #005a5f;">v</span> <span style="color: #2544bb;">"%~2"</span> &gt; <span style="color: #2544bb;">"%TEMP%\_envset.tmp"</span> 2&gt;NUL
    <span style="color: #5317ac;">for</span> /<span style="color: #005a5f;">f</span> <span style="color: #2544bb;">"usebackq skip=2 tokens=2,*"</span> %%<span style="color: #00538b;">A</span> <span style="color: #5317ac;">IN</span> (<span style="color: #2544bb;">"%TEMP%\_envset.tmp"</span>) <span style="color: #5317ac;">do</span> (
        echo/set <span style="color: #2544bb;">"%~3=%%B"</span>
    )
    <span style="color: #5317ac;">goto</span> <span style="color: #0000c0;">:EOF</span>

<span style="font-weight: bold;">:GetRegEnv</span>
    <span style="color: #2544bb;">"%WinDir%\System32\Reg"</span> QUERY <span style="color: #2544bb;">"%~1"</span> &gt; <span style="color: #2544bb;">"%TEMP%\_envget.tmp"</span>
    <span style="color: #5317ac;">for</span> /<span style="color: #005a5f;">f</span> <span style="color: #2544bb;">"usebackq skip=2"</span> %%<span style="color: #00538b;">A</span> <span style="color: #5317ac;">IN</span> (<span style="color: #2544bb;">"%TEMP%\_envget.tmp"</span>) <span style="color: #5317ac;">do</span> (
        <span style="color: #5317ac;">if</span> /<span style="color: #005a5f;">I</span> <span style="color: #5317ac;">not</span> <span style="color: #2544bb;">"%%~A"</span>==<span style="color: #2544bb;">"Path"</span> (
            <span style="color: #5317ac;">call</span> <span style="color: #0000c0;">:SetFromReg</span> <span style="color: #2544bb;">"%~1"</span> <span style="color: #2544bb;">"%%~A"</span> <span style="color: #2544bb;">"%%~A"</span>
        )
    )
    <span style="color: #5317ac;">goto</span> <span style="color: #0000c0;">:EOF</span>

<span style="font-weight: bold;">:main</span>
    echo/@<span style="color: #8f0075;">echo</span> off &gt;<span style="color: #2544bb;">"%TEMP%\_env.cmd"</span>

    <span style="color: #5317ac;">call</span> <span style="color: #0000c0;">:GetRegEnv</span> <span style="color: #2544bb;">"HKLM\System\CurrentControlSet\Control\Session Manager\Environment"</span> &gt;&gt; <span style="color: #2544bb;">"%TEMP%\_env.cmd"</span>
    <span style="color: #5317ac;">call</span> <span style="color: #0000c0;">:GetRegEnv</span> <span style="color: #2544bb;">"HKCU\Environment"</span>&gt;&gt;<span style="color: #2544bb;">"%TEMP%\_env.cmd"</span> &gt;&gt; <span style="color: #2544bb;">"%TEMP%\_env.cmd"</span>

    <span style="color: #5317ac;">call</span> <span style="color: #0000c0;">:SetFromReg</span> <span style="color: #2544bb;">"HKLM\System\CurrentControlSet\Control\Session Manager\Environment"</span> <span style="color: #8f0075;">Path</span> Path_HKLM &gt;&gt; <span style="color: #2544bb;">"%TEMP%\_env.cmd"</span>
    <span style="color: #5317ac;">call</span> <span style="color: #0000c0;">:SetFromReg</span> <span style="color: #2544bb;">"HKCU\Environment"</span> <span style="color: #8f0075;">Path</span> Path_HKCU &gt;&gt; <span style="color: #2544bb;">"%TEMP%\_env.cmd"</span>

    echo/set <span style="color: #2544bb;">"Path=%%Path_HKLM%%;%%Path_HKCU%%"</span> &gt;&gt; <span style="color: #2544bb;">"%TEMP%\_env.cmd"</span>

    <span style="color: #8f0075;">del</span> /<span style="color: #005a5f;">f</span> /<span style="color: #005a5f;">q</span> <span style="color: #2544bb;">"%TEMP%\_envset.tmp"</span> 2&gt;nul
    <span style="color: #8f0075;">del</span> /<span style="color: #005a5f;">f</span> /<span style="color: #005a5f;">q</span> <span style="color: #2544bb;">"%TEMP%\_envget.tmp"</span> 2&gt;nul

    <span style="color: #8f0075;">SET</span> <span style="color: #2544bb;">"OriginalUserName=%USERNAME%"</span>
    <span style="color: #8f0075;">SET</span> <span style="color: #2544bb;">"OriginalArchitecture=%PROCESSOR_ARCHITECTURE%"</span>

    <span style="color: #5317ac;">call</span> <span style="color: #2544bb;">"%TEMP%\_env.cmd"</span>

    <span style="color: #8f0075;">del</span> /<span style="color: #005a5f;">f</span> /<span style="color: #005a5f;">q</span> <span style="color: #2544bb;">"%TEMP%\_env.cmd"</span> 2&gt;nul

    <span style="color: #8f0075;">SET</span> <span style="color: #2544bb;">"USERNAME=%OriginalUserName%"</span>
    <span style="color: #8f0075;">SET</span> <span style="color: #2544bb;">"PROCESSOR_ARCHITECTURE=%OriginalArchitecture%"</span>

    <span style="color: #8f0075;">echo</span> | <span style="color: #8f0075;">set</span> <span style="color: #00538b;">/</span><span style="color: #00538b;">p</span> dummy=<span style="color: #2544bb;">"Finished."</span>
    <span style="color: #8f0075;">echo</span> .

</pre>
</div>

<p>
This is a script I wrote to add a current folder to the path:
</p>

<div class="org-src-container">
<pre class="src src-bat">      @<span style="color: #8f0075;">echo</span> off
  <span style="color: #8f0075;">set</span> <span style="color: #00538b;">add</span>=%<span style="color: #00538b;">1</span>
  <span style="color: #8f0075;">shift</span>
  <span style="color: #5317ac;">if</span> [%<span style="color: #00538b;">add</span>%] == [] ( <span style="color: #8f0075;">set</span> <span style="color: #00538b;">add</span>=%<span style="color: #00538b;">cd</span>% )
  <span style="color: #5317ac;">if</span> <span style="color: #5317ac;">exist</span> %<span style="color: #00538b;">add</span>% (
    <span style="color: #8f0075;">set</span> <span style="color: #00538b;">PATH</span>=<span style="color: #2544bb;">"%PATH%;%add%"</span>
  ) <span style="color: #5317ac;">else</span> (
    <span style="color: #8f0075;">echo</span> Error; the location %<span style="color: #00538b;">add</span>% could <span style="color: #5317ac;">not</span> be found.
    <span style="color: #8f0075;">echo</span> Please try again.
  )
<span style="color: #505050;">:: Refresh Env</span>
  C:\<span style="color: #5317ac;">CMD</span>\bin\refresh.bat
</pre>
</div>

<p>
In the end, however, I got bored of adding the same files all the time to my <code>PATH</code>, so I decided to just put this ugly thing in a script to make it easier when swapping machines:
</p>

<div class="org-src-container">
<pre class="src src-bat">@<span style="color: #8f0075;">echo</span> off
reg add HKEY_CURRENT_USER\Environment /<span style="color: #005a5f;">v</span> <span style="color: #8f0075;">PATH</span> /<span style="color: #005a5f;">d</span> <span style="color: #2544bb;">"%PATH%;C:\cmd;C:\cmd\ahk;C:\cmd\bin;C:\cmd\hours;C:\cmd\hours\bin;C:\cmd\shortcuts;C:\Users\%USERNAME%\Documents\Personal Admin\Vim\vim81;C:\Program Files\VideoLAN;C:\cmd\exe\;C:\MAMP\bin\ruby\bin\;C:\MAMP\bin\python\bin\"</span>
<span style="color: #5317ac;">call</span> <span style="color: #0000c0;">C:\cmd\bin\refresh.bat</span>
</pre>
</div>

<p>
Which doesn't work properly, because it needs to be set with <code>/M</code> I believe, which requires admin&#x2026; might need to be always done through the GUI, for some reason, to be persistent. Or might require a restart. Not sure. Needs testing.
</p>
</div>
</div>

<div id="outline-container-org1eb157d" class="outline-3">
<h3 id="org1eb157d">Quick Navigation with CMD</h3>
<div class="outline-text-3" id="text-org1eb157d">
<p>
This script creates drive locations. It simply loops through lettered drives available and creates a shortcut (just a <code>.bat</code> file with the content <code>cd DRIVE:</code>) that's it. It allows you to type <code>j</code> in the CMD prompt and go to the <code>J:\</code> drive, for example:
</p>

<div class="org-src-container">
<pre class="src src-bat">@<span style="color: #8f0075;">echo</span> off

        <span style="color: #8f0075;">set</span> <span style="color: #00538b;">shortcuts</span>=C:\<span style="color: #5317ac;">CMD</span>\shortcuts
        <span style="color: #5317ac;">if</span> <span style="color: #5317ac;">not</span> <span style="color: #5317ac;">exist</span> %<span style="color: #00538b;">shortcuts</span>% ( <span style="color: #8f0075;">mkdir</span> %<span style="color: #00538b;">shortcuts</span>% )

        <span style="color: #5317ac;">for</span> %%<span style="color: #00538b;">a</span> <span style="color: #5317ac;">in</span> (a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z) <span style="color: #5317ac;">do</span> (
                <span style="color: #5317ac;">if</span> <span style="color: #5317ac;">exist</span> %%<span style="color: #00538b;">a:\</span> (
                        <span style="color: #8f0075;">echo</span> @<span style="color: #8f0075;">echo</span> off&gt;%<span style="color: #00538b;">shortcuts</span>%\%%<span style="color: #00538b;">a.bat</span>
                        <span style="color: #8f0075;">echo</span> REM added automatically by script&gt;&gt;%<span style="color: #00538b;">shortcuts</span>%\%%<span style="color: #00538b;">a.bat</span>
                        <span style="color: #8f0075;">echo</span> %%<span style="color: #00538b;">a:&gt;&gt;</span>%shortcuts%<span style="color: #00538b;">\</span>%%<span style="color: #00538b;">a.bat</span>
                        <span style="color: #8f0075;">echo</span> %%<span style="color: #00538b;">a:\</span> has been added as a shortcut
                ) <span style="color: #5317ac;">else</span> (
                        <span style="color: #8f0075;">echo</span> %%<span style="color: #00538b;">a:\</span> does <span style="color: #5317ac;">not</span> <span style="color: #5317ac;">exist</span>
                )
        )
</pre>
</div>

<p>
Another script that allows for quick navigation around the CMD Prompt is this, which creates shortcuts to the directory you're currently in:
</p>

<div class="org-src-container">
<pre class="src src-bat">@<span style="color: #8f0075;">echo</span> off

<span style="color: #505050;">:: Defaults</span>
  <span style="color: #8f0075;">set</span> <span style="color: #00538b;">shortdir</span>=C:\<span style="color: #5317ac;">CMD</span>\shortcuts
  <span style="color: #5317ac;">if</span> <span style="color: #5317ac;">not</span> <span style="color: #5317ac;">exist</span> %<span style="color: #00538b;">shortdir</span>% <span style="color: #8f0075;">mkdir</span> %<span style="color: #00538b;">shortdir</span>%
        <span style="color: #505050;">:: Home Dir</span>
        <span style="color: #5317ac;">if</span> <span style="color: #5317ac;">not</span> <span style="color: #5317ac;">exist</span> %<span style="color: #00538b;">shortdir</span>%\home.bat (
          <span style="color: #8f0075;">echo</span> @<span style="color: #8f0075;">echo</span> off&gt;%<span style="color: #00538b;">shortdir</span>%\home.bat
          <span style="color: #8f0075;">echo</span> C:^&gt;nul&gt;&gt;%<span style="color: #00538b;">shortdir</span>%\home.bat
          <span style="color: #8f0075;">echo</span> <span style="color: #8f0075;">cd</span> %<span style="color: #00538b;">homepath</span>%&gt;&gt;%<span style="color: #00538b;">shortdir</span>%\home.bat
          <span style="color: #8f0075;">echo</span> C:%<span style="color: #00538b;">homepath</span>% shortcut created!
        ) <span style="color: #5317ac;">else</span> (
          <span style="color: #8f0075;">echo</span> C:%<span style="color: #00538b;">homepath</span>% shortcut is already established.
        )
        <span style="color: #505050;">:: C:\CMD Dir</span>
        <span style="color: #5317ac;">if</span> <span style="color: #5317ac;">not</span> <span style="color: #5317ac;">exist</span> %<span style="color: #00538b;">shortdir</span>%\dev.bat (
          <span style="color: #8f0075;">echo</span> @<span style="color: #8f0075;">echo</span> off&gt;%<span style="color: #00538b;">shortdir</span>%\dev.bat
          <span style="color: #8f0075;">echo</span> C:^&gt;nul&gt;&gt;%<span style="color: #00538b;">shortdir</span>%\dev.bat
          <span style="color: #8f0075;">echo</span> <span style="color: #8f0075;">cd</span> \<span style="color: #5317ac;">CMD</span>\&gt;&gt;%<span style="color: #00538b;">shortdir</span>%\dev.bat
          <span style="color: #8f0075;">echo</span> C:\<span style="color: #5317ac;">CMD</span> shortcut created!
        ) <span style="color: #5317ac;">else</span> (
          <span style="color: #8f0075;">echo</span> C:\<span style="color: #5317ac;">CMD</span> shortcut is already established.
        )

  <span style="color: #8f0075;">set</span> <span style="color: #00538b;">sname</span>=%<span style="color: #00538b;">1</span>
  <span style="color: #8f0075;">shift</span>
  <span style="color: #5317ac;">if</span> [%<span style="color: #00538b;">sname</span>%] == [] (
        <span style="color: #8f0075;">echo</span>. 
        <span style="color: #8f0075;">echo</span> <span style="color: #5317ac;">If</span> you are looking to <span style="color: #8f0075;">set</span> <span style="color: #00538b;">up</span> shortcuts to this folder, 
        <span style="color: #8f0075;">echo</span> use this command like 'shortcut NAME'.
        <span style="color: #5317ac;">exit</span> /<span style="color: #005a5f;">b</span>
  )

  <span style="color: #8f0075;">set</span> <span style="color: #00538b;">snameext</span>=%<span style="color: #00538b;">sname:</span>~-3%
  <span style="color: #5317ac;">if</span> %<span style="color: #00538b;">snameext</span>% == bat <span style="color: #8f0075;">set</span> <span style="color: #00538b;">sname</span>=%<span style="color: #00538b;">sname:</span>~0,-4%
  <span style="color: #5317ac;">if</span> %<span style="color: #00538b;">snameext</span>% == <span style="color: #5317ac;">cmd</span> <span style="color: #8f0075;">set</span> <span style="color: #00538b;">sname</span>=%<span style="color: #00538b;">sname:</span>~0,-4%

  <span style="color: #5317ac;">if</span> <span style="color: #5317ac;">exist</span> <span style="color: #2544bb;">"%shortdir%\%sname%.bat"</span> (
    <span style="color: #8f0075;">echo</span> Error; a shortcut of this name already exists.
    <span style="color: #5317ac;">exit</span> /<span style="color: #005a5f;">b</span>
  )

  <span style="color: #8f0075;">set</span> <span style="color: #00538b;">drive</span>=%<span style="color: #00538b;">cd:</span>~0,1%

  <span style="color: #8f0075;">echo</span> @<span style="color: #8f0075;">echo</span> off&gt;%<span style="color: #00538b;">shortdir</span>%\%<span style="color: #00538b;">sname</span>%.bat
  <span style="color: #8f0075;">echo</span> %<span style="color: #00538b;">drive</span>%:^&gt;nul&gt;&gt;%<span style="color: #00538b;">shortdir</span>%\%<span style="color: #00538b;">sname</span>%.bat
  <span style="color: #8f0075;">echo</span> <span style="color: #8f0075;">cd</span> %<span style="color: #00538b;">cd</span>%&gt;&gt;%<span style="color: #00538b;">shortdir</span>%\%<span style="color: #00538b;">sname</span>%.bat

<span style="color: #505050;">:: Feedback to the User</span>
  <span style="color: #8f0075;">echo</span> Shortcut should now be working!
  <span style="color: #8f0075;">echo</span> Try it by typing <span style="color: #2544bb;">"%sname%"</span> from another <span style="color: #8f0075;">dir</span>.
</pre>
</div>

<p>
It also sets up the following useful locations, when you first run it:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Shortcut</th>
<th scope="col" class="org-left">Path</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>dev</code></td>
<td class="org-left"><code>c:/cmd/</code></td>
</tr>

<tr>
<td class="org-left"><code>home</code></td>
<td class="org-left"><code>c:/Users/&lt;currentUser&gt;/</code></td>
</tr>
</tbody>
</table>

<p>
The shortcut files it creates follow this format:
</p>

<div class="org-src-container">
<pre class="src src-bat">
@<span style="color: #8f0075;">echo</span> off
%<span style="color: #00538b;">drive</span>%:&gt;nul
<span style="color: #8f0075;">cd</span> %<span style="color: #00538b;">cd</span>%

</pre>
</div>
</div>
</div>

<div id="outline-container-org44e740a" class="outline-3">
<h3 id="org44e740a">Ping-Based Scripts</h3>
<div class="outline-text-3" id="text-org44e740a">
<p>
Some of my utilities work in tandem with a script designed to send GUI notifications with VBScript:
</p>

<div class="org-src-container">
<pre class="src src-VBScript">Set objArgs = WScript.Arguments
messageText = objArgs(0)
MsgBox messageText
</pre>
</div>

<p>
One script that makes use of this, quite well in my opinion, is <i>amiconnected</i>. It simply tests whether you're connected to the internet (using <code>ping</code>), and notifies you when you go back online: 
</p>

<div class="org-src-container">
<pre class="src src-bat">
@<span style="color: #8f0075;">echo</span> off
@<span style="color: #8f0075;">setlocal</span> enableextensions enabledelayedexpansion

<span style="color: #8f0075;">echo</span>.
<span style="color: #8f0075;">echo</span> Try running with 'notify' as an argument. It will
<span style="color: #8f0075;">echo</span> notify you via a popup when your connection is re-established...
<span style="color: #8f0075;">echo</span>.
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">oldstate</span>=Error
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">notify</span>=false
<span style="color: #5317ac;">if</span> [%<span style="color: #00538b;">1]==[]</span> (
  <span style="color: #8f0075;">set</span> <span style="color: #00538b;">ipaddress</span>=google.com
) <span style="color: #5317ac;">else</span> (
  <span style="color: #5317ac;">if</span> [%<span style="color: #00538b;">1]==[notify]</span> (
    <span style="color: #8f0075;">set</span> <span style="color: #00538b;">ipaddress</span>=google.com
    <span style="color: #8f0075;">set</span> <span style="color: #00538b;">notify</span>=true
  ) <span style="color: #5317ac;">else</span> (
    <span style="color: #8f0075;">set</span> <span style="color: #00538b;">ipaddress</span>=%<span style="color: #00538b;">1</span>
  )
)

<span style="font-weight: bold;">:loop</span>
  <span style="color: #8f0075;">set</span> <span style="color: #00538b;">state</span>=Down
  <span style="color: #5317ac;">for</span> /<span style="color: #005a5f;">f</span> <span style="color: #2544bb;">"tokens=5,7"</span> %%<span style="color: #00538b;">a</span> <span style="color: #5317ac;">in</span> ('ping -<span style="color: #005a5f;">n</span> 1 !<span style="color: #00538b;">ipaddress</span>!') <span style="color: #5317ac;">do</span> (
      <span style="color: #5317ac;">if</span> <span style="color: #2544bb;">"x%%a"</span>==<span style="color: #2544bb;">"xReceived"</span> <span style="color: #5317ac;">if</span> <span style="color: #2544bb;">"x%%b"</span>==<span style="color: #2544bb;">"x1,"</span> <span style="color: #8f0075;">set</span> <span style="color: #00538b;">state</span>=Up
  )
  <span style="color: #5317ac;">if</span> <span style="color: #5317ac;">not</span> !<span style="color: #00538b;">state</span>!==!<span style="color: #00538b;">oldstate</span>! (
    <span style="color: #8f0075;">echo</span>    Pinging: !<span style="color: #00538b;">ipaddress</span>!    State: !<span style="color: #00538b;">state</span>!
    <span style="color: #8f0075;">set</span> <span style="color: #00538b;">oldstate</span>=!<span style="color: #00538b;">state</span>!
  )
  <span style="color: #8f0075;">pushd</span> \<span style="color: #5317ac;">CMD</span>\bin
  <span style="color: #5317ac;">if</span> [%<span style="color: #00538b;">2]==[notify]</span> <span style="color: #8f0075;">set</span> <span style="color: #00538b;">notify</span>=true
  <span style="color: #5317ac;">if</span> [!<span style="color: #00538b;">notify</span>!]==[true] (
    <span style="color: #5317ac;">if</span> [!<span style="color: #00538b;">state</span>!]==[Up] (
    <span style="color: #505050;">:: Use msgBox.vbs to notify</span>
      WScript msgBox.vbs Connected
      <span style="color: #5317ac;">goto</span> <span style="color: #0000c0;">:end</span>
    )
  )
  ping -<span style="color: #005a5f;">n</span> 2 127.0.0.1 &gt;nul: 2&gt;nul:
<span style="color: #5317ac;">goto</span> <span style="color: #0000c0;">:loop</span>
<span style="font-weight: bold;">:end</span>
<span style="color: #8f0075;">endlocal</span>

</pre>
</div>

<p>
This is a very specific tool created to find out how many instances of a domain, containing numbers, exist.  For example:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Command</th>
<th scope="col" class="org-left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>ping test1.com</code></td>
<td class="org-left">Exists</td>
</tr>

<tr>
<td class="org-left"><code>ping test2.com</code></td>
<td class="org-left">Exists</td>
</tr>

<tr>
<td class="org-left"><code>ping test3.com</code></td>
<td class="org-left">Ping Failed</td>
</tr>

<tr>
<td class="org-left"><code>...</code></td>
<td class="org-left">&#x2026;</td>
</tr>

<tr>
<td class="org-left"><code>ping test99.com</code></td>
<td class="org-left">Ping Failed</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-bat">@<span style="color: #8f0075;">echo</span> off
<span style="color: #8f0075;">echo</span> Numbered Domain Search
<span style="color: #8f0075;">echo</span>.
<span style="color: #8f0075;">echo</span> Very specific tool used to <span style="color: #8f0075;">find</span> out how many instances of a domain with
<span style="color: #8f0075;">echo</span> numbers after e.g. test1.com, test2.com, test3.com, etc. are live/pingable.
<span style="color: #8f0075;">echo</span>.
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">/</span><span style="color: #00538b;">p</span> <span style="color: #5317ac;">start</span>=<span style="color: #2544bb;">"Enter the start (e.g. thisdomain, not thisdomain.com): "</span>
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">/</span><span style="color: #00538b;">p</span> ender=<span style="color: #2544bb;">"Enter the end (e.g. .com, etc) if applicable: "</span>
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">/</span><span style="color: #00538b;">p</span> no=<span style="color: #2544bb;">"Search to number... : "</span>
<span style="color: #8f0075;">echo</span> Searching %<span style="color: #00538b;">start</span>%X%<span style="color: #00538b;">ender</span>%, to number %<span style="color: #00538b;">no</span>%...
<span style="color: #5317ac;">for</span> /<span style="color: #005a5f;">l</span> %%<span style="color: #00538b;">x</span> <span style="color: #5317ac;">in</span> (1, 1, %<span style="color: #00538b;">no</span>%) <span style="color: #5317ac;">do</span> (
ping -<span style="color: #005a5f;">n</span> 1 %<span style="color: #00538b;">start</span>%%%<span style="color: #00538b;">x</span>%ender% | <span style="color: #8f0075;">find</span> <span style="color: #2544bb;">"TTL="</span> &gt;nul
<span style="color: #5317ac;">if</span> <span style="color: #5317ac;">not</span> errorlevel 1 (  <span style="color: #8f0075;">echo</span> %<span style="color: #00538b;">start</span>%%%<span style="color: #00538b;">x</span>%ender% is online )
)
</pre>
</div>
</div>
</div>

<div id="outline-container-org859f671" class="outline-3">
<h3 id="org859f671">Very Small and/or Unix-y</h3>
<div class="outline-text-3" id="text-org859f671">
<p>
Here's a painfully small script, but one I use very frequently. It just opens the directory you're in with <i>explorer.exe</i>:
</p>

<div class="org-src-container">
<pre class="src src-bat">@<span style="color: #8f0075;">echo</span> off
explorer .
</pre>
</div>

<p>
Here's a script that just adds the files in the current folder to a text-file:
</p>

<div class="org-src-container">
<pre class="src src-bat">@<span style="color: #8f0075;">echo</span> off
<span style="color: #8f0075;">dir</span> /<span style="color: #005a5f;">b</span> /<span style="color: #005a5f;">a</span>-d&gt;&gt;<span style="color: #2544bb;">"folder-contents.txt"</span>
</pre>
</div>

<p>
The following are similar to a Unix counterpart. This is similar to <code>ls -a</code>:
</p>

<div class="org-src-container">
<pre class="src src-bat">
@<span style="color: #8f0075;">echo</span> off

<span style="color: #8f0075;">set</span> <span style="color: #00538b;">location</span>=%<span style="color: #00538b;">1</span>
<span style="color: #8f0075;">shift</span>

<span style="color: #5317ac;">if</span> [%<span style="color: #00538b;">location</span>%] == [] (
        <span style="color: #8f0075;">echo</span>. 
        <span style="color: #8f0075;">echo</span>.Folders:
        <span style="color: #8f0075;">dir</span> /<span style="color: #005a5f;">b</span> /<span style="color: #005a5f;">o</span> /<span style="color: #005a5f;">a</span>:d .
        <span style="color: #8f0075;">echo</span>.
        <span style="color: #8f0075;">echo</span>.Files:
        <span style="color: #8f0075;">dir</span> /<span style="color: #005a5f;">b</span> /<span style="color: #005a5f;">o</span> /<span style="color: #005a5f;">a</span>:-d .
) <span style="color: #5317ac;">else</span> (
  <span style="color: #8f0075;">echo</span>. 
  <span style="color: #8f0075;">echo</span>.Folders:
  <span style="color: #8f0075;">dir</span> /<span style="color: #005a5f;">b</span> /<span style="color: #005a5f;">o</span> /<span style="color: #005a5f;">a</span>:d %<span style="color: #00538b;">location</span>%
  <span style="color: #8f0075;">echo</span>.
  <span style="color: #8f0075;">echo</span>.Files:
  <span style="color: #8f0075;">dir</span> /<span style="color: #005a5f;">b</span> /<span style="color: #005a5f;">o</span> /<span style="color: #005a5f;">a</span>:-d %<span style="color: #00538b;">location</span>%
)

</pre>
</div>

<p>
This is similar to <code>touch</code>:
</p>

<div class="org-src-container">
<pre class="src src-bat">
@<span style="color: #8f0075;">echo</span> off

<span style="color: #5317ac;">for</span> %%<span style="color: #00538b;">A</span> <span style="color: #5317ac;">in</span> (%<span style="color: #00538b;">*)</span> <span style="color: #5317ac;">do</span> (
        <span style="color: #5317ac;">if</span> <span style="color: #5317ac;">exist</span> %%<span style="color: #00538b;">A</span> (
                <span style="color: #8f0075;">echo</span> %%<span style="color: #00538b;">A</span> already exists, could <span style="color: #5317ac;">not</span> create file.
        ) <span style="color: #5317ac;">else</span> (
                <span style="color: #8f0075;">copy</span> NUL %%<span style="color: #00538b;">A</span> &gt;NUL
                <span style="color: #8f0075;">echo</span> %%<span style="color: #00538b;">A</span> successfully created
        )
)

</pre>
</div>

<p>
This is similar to <code>rm</code>:
</p>

<div class="org-src-container">
<pre class="src src-bat">@<span style="color: #8f0075;">echo</span> off

<span style="color: #5317ac;">for</span> %%<span style="color: #00538b;">a</span> <span style="color: #5317ac;">in</span> (%<span style="color: #00538b;">*)</span> <span style="color: #5317ac;">do</span> (
  <span style="color: #5317ac;">if</span> <span style="color: #5317ac;">exist</span> %%<span style="color: #00538b;">a\NUL</span> (<span style="color: #8f0075;">rmdir</span> <span style="color: #2544bb;">"%%a"</span> /<span style="color: #005a5f;">S</span> /<span style="color: #005a5f;">Q</span>) <span style="color: #5317ac;">else</span> (<span style="color: #8f0075;">del</span> <span style="color: #2544bb;">"%%a"</span>)
)
</pre>
</div>

<p>
This is similar to <code>cp</code>:
</p>

<div class="org-src-container">
<pre class="src src-bat">@<span style="color: #8f0075;">echo</span> off
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">in</span>=%<span style="color: #00538b;">1</span>
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">out</span>=%<span style="color: #00538b;">2</span>
<span style="color: #8f0075;">shift</span>
<span style="color: #8f0075;">shift</span>
<span style="color: #8f0075;">xcopy</span> <span style="color: #2544bb;">"%in%"</span> <span style="color: #2544bb;">"%out%"</span>
</pre>
</div>

<p>
Here's something&#x2026; I'm hesitant to use the word <i>similar</i> here&#x2026; it's a very slow, very poorly written <a href="https://en.wikipedia.org/wiki/Shred_(Unix)">GNU Shred</a>:
</p>

<div class="org-src-container">
<pre class="src src-bat">
@<span style="color: #8f0075;">echo</span> off
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">filename</span>=%<span style="color: #00538b;">1</span>
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">extra</span>=%<span style="color: #00538b;">2</span>
<span style="color: #8f0075;">shift</span>
<span style="color: #8f0075;">shift</span>
<span style="color: #5317ac;">if</span> <span style="color: #5317ac;">not</span> [%<span style="color: #00538b;">extra</span>%] == [] <span style="color: #8f0075;">echo</span> This command only accepts single arguments <span style="color: #5317ac;">for</span> the moment; one file <span style="color: #8f0075;">at</span> a <span style="color: #8f0075;">time</span> please!
<span style="color: #5317ac;">if</span> [%<span style="color: #00538b;">filename</span>%] == [] <span style="color: #8f0075;">set</span> <span style="color: #00538b;">/</span><span style="color: #00538b;">p</span> <span style="color: #2544bb;">"filename=Please enter filename: "</span>
<span style="color: #5317ac;">if</span> <span style="color: #5317ac;">not</span> <span style="color: #5317ac;">exist</span> %<span style="color: #00538b;">filename</span>% (
<span style="color: #8f0075;">echo</span> This file does <span style="color: #5317ac;">not</span> <span style="color: #5317ac;">exist</span>!
<span style="color: #5317ac;">exit</span> /<span style="color: #005a5f;">b</span>
)
<span style="color: #505050;">:: Number of chars in file...</span>
<span style="color: #5317ac;">for</span> %%<span style="color: #00538b;">i</span> <span style="color: #5317ac;">in</span> (%<span style="color: #00538b;">filename</span>%) <span style="color: #5317ac;">do</span> @<span style="color: #8f0075;">set</span> <span style="color: #00538b;">chars</span>=%%~z<span style="color: #00538b;">i</span>
<span style="color: #8f0075;">echo</span> This file contains %<span style="color: #00538b;">chars</span>% characters.
<span style="color: #505050;">:: Empty file and set new chars</span>
&lt;nul <span style="color: #8f0075;">set</span> <span style="color: #00538b;">/</span><span style="color: #00538b;">p</span>=&gt;%<span style="color: #00538b;">filename</span>%
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">charstr</span>=1234567890abcdefghijklmnopqrstuvwxyz
<span style="color: #8f0075;">setlocal</span> enabledelayedexpansion
<span style="color: #5317ac;">for</span> /<span style="color: #005a5f;">l</span> %%<span style="color: #00538b;">a</span> <span style="color: #5317ac;">in</span> (1, 1, %<span style="color: #00538b;">chars</span>%) <span style="color: #5317ac;">do</span> (
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">/</span><span style="color: #00538b;">a</span> randchar=!<span style="color: #00538b;">random</span>! %%<span style="color: #00538b;">36</span>
<span style="color: #5317ac;">call</span> <span style="color: #0000c0;">set</span> <span style="color: #00538b;">randomcharacter</span>=%%<span style="color: #00538b;">charstr:</span>~!<span style="color: #00538b;">randchar</span>!,1%%
&lt;nul <span style="color: #8f0075;">set</span> <span style="color: #00538b;">/</span><span style="color: #00538b;">p</span>=!<span style="color: #00538b;">randomcharacter</span>!&gt;&gt;!<span style="color: #00538b;">filename</span>!
)

</pre>
</div>

<p>
I would <b>not</b> recommend using this.
</p>
</div>
</div>
</div>

<div id="outline-container-orgbb5eb0f" class="outline-2">
<h2 id="orgbb5eb0f">Powershell</h2>
<div class="outline-text-2" id="text-orgbb5eb0f">
</div>
<div id="outline-container-orgde466b5" class="outline-3">
<h3 id="orgde466b5">No Admin Powershell</h3>
<div class="outline-text-3" id="text-orgde466b5">
<p>
I can't use admin. As a result, I invoke Powershell from CMD, like this:
</p>

<div class="org-src-container">
<pre class="src src-bat">@<span style="color: #8f0075;">echo</span> off
  <span style="color: #8f0075;">set</span> <span style="color: #00538b;">psdir</span>=<span style="color: #2544bb;">"C:\%homepath%\Documents\WindowsPowerShell"</span>
  <span style="color: #5317ac;">if</span> <span style="color: #5317ac;">not</span> <span style="color: #5317ac;">exist</span> %<span style="color: #00538b;">psdir</span>% <span style="color: #8f0075;">mkdir</span> %<span style="color: #00538b;">psdir</span>%
  <span style="color: #5317ac;">if</span> <span style="color: #5317ac;">not</span> <span style="color: #5317ac;">exist</span> %<span style="color: #00538b;">psdir</span>%\Microsoft.PowerShell_profile.ps1 (
    <span style="color: #8f0075;">xcopy</span> C:\<span style="color: #5317ac;">CMD</span>\psrc.ps1 %<span style="color: #00538b;">psdir</span>%\Microsoft.Powershell_profile.ps1 
  ) <span style="color: #5317ac;">else</span> (
    <span style="color: #8f0075;">xcopy</span> C:\<span style="color: #5317ac;">CMD</span>\psrc.ps1 %<span style="color: #00538b;">psdir</span>%\Microsoft.PowerShell_profile.ps1 /<span style="color: #005a5f;">Y</span> &gt; nul
  )
  <span style="color: #8f0075;">echo</span>.
  powershell.exe -<span style="color: #005a5f;">ExecutionPolicy</span> bypass -<span style="color: #005a5f;">NoLogo</span>
</pre>
</div>

<p>
This copies the Powershell configuration to the correct directory, too; the key bit being:
</p>

<div class="org-src-container">
<pre class="src src-bat">powershell.exe -<span style="color: #005a5f;">ExecutionPolicy</span> bypass -<span style="color: #005a5f;">NoLogo</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org97e55f7" class="outline-3">
<h3 id="org97e55f7">Config</h3>
<div class="outline-text-3" id="text-org97e55f7">
<p>
Powershell is far better at this, and can have a more complex configuration. However, on my machine at work, it's often easier to use CMD due to the lack of admin level access. Therefore my Powershell configuration isn't as mature as I'd like, in an ideal world. 
</p>

<p>
This part styles the prompt minimally.
</p>

<div class="org-src-container">
<pre class="src src-powershell"><span style="color: #5317ac;">function</span> prompt {
    <span style="color: #2544bb;">" $ $(Split-Path -Path (Get-Location) -Leaf) &gt; "</span>
}
</pre>
</div>

<p>
This function is used to set a wallpaper (more on this later). It's basically taken from <a href="https://techexpert.tips/powershell/powershell-configure-wallpaper/">here</a>.
</p>

<div class="org-src-container">
<pre class="src src-powershell">  <span style="color: #5317ac;">function</span> <span style="color: #721045;">Set-Wallpaper</span>(<span style="color: #00538b;">$MyWallpaper</span>) {
  <span style="color: #00538b;">$code</span> = @<span style="color: #2544bb;">' </span>
<span style="color: #2544bb;">  using System.Runtime.InteropServices; </span>
<span style="color: #2544bb;">  namespace Win32{ </span>
<span style="color: #2544bb;">    public class Wallpaper{ </span>
<span style="color: #2544bb;">      [DllImport("user32.dll", CharSet=CharSet.Auto)] </span>
<span style="color: #2544bb;">      static extern int SystemParametersInfo (int uAction , int uParam , string lpvParam , int fuWinIni) ; </span>

<span style="color: #2544bb;">      public static void SetWallpaper(string thePath){ </span>
<span style="color: #2544bb;">        SystemParametersInfo(20,0,thePath,3); </span>
<span style="color: #2544bb;">      }</span>
<span style="color: #2544bb;">    }</span>
<span style="color: #2544bb;">  } </span>
<span style="color: #2544bb;">'@</span>

<span style="color: #2544bb;">  add-type $code </span>
<span style="color: #2544bb;">  [Win32.Wallpaper]::SetWallpaper($MyWallpaper)</span>
<span style="color: #2544bb;">  }</span>

</pre>
</div>

<p>
These functions are used to manipulate <code>.lnk</code>'s, and specifically to add keyboard shortcuts to them; a useful and possibly little known way to avoid using AutoHotkey. It's also quite unreliable! 
</p>

<div class="org-src-container">
<pre class="src src-powershell">
<span style="color: #5317ac;">function</span> <span style="color: #721045;">Get-Shortcut</span> {
  <span style="color: #5317ac;">param</span>(
    <span style="color: #00538b;">$path</span> = <span style="color: #8f0075;">$null</span>
  )
  <span style="color: #00538b;">$obj</span> = <span style="color: #721045;">New-Object</span> <span style="color: #0000c0;">-ComObject</span> WScript.Shell
  <span style="color: #5317ac;">if</span> (<span style="color: #00538b;">$path</span> <span style="color: #8f0075;">-eq</span> <span style="color: #8f0075;">$null</span>) {
    <span style="color: #00538b;">$pathUser</span> = <span style="color: #005a5f;">[System.Environment]</span>::GetFolderPath(<span style="color: #2544bb;">'StartMenu'</span>)
    <span style="color: #00538b;">$pathCommon</span> = <span style="color: #00538b;">$obj</span>.SpecialFolders.Item(<span style="color: #2544bb;">'AllUsersStartMenu'</span>)
    <span style="color: #00538b;">$path</span> = dir <span style="color: #00538b;">$pathUser</span>, <span style="color: #00538b;">$pathCommon</span> <span style="color: #0000c0;">-Filter</span> *.lnk <span style="color: #0000c0;">-Recurse</span> 
  }
  <span style="color: #5317ac;">if</span> (<span style="color: #00538b;">$path</span> <span style="color: #8f0075;">-is</span> <span style="color: #005a5f;">[string]</span>) {
    <span style="color: #00538b;">$path</span> = dir <span style="color: #00538b;">$path</span> <span style="color: #0000c0;">-Filter</span> *.lnk
  }
  <span style="color: #00538b;">$path</span> | <span style="color: #721045;">ForEach-Object</span> { 
    <span style="color: #5317ac;">if</span> (<span style="color: #8f0075;">$_</span> <span style="color: #8f0075;">-is</span> <span style="color: #005a5f;">[string]</span>) {
      <span style="color: #8f0075;">$_</span> = dir <span style="color: #8f0075;">$_</span> <span style="color: #0000c0;">-Filter</span> *.lnk
    }
    <span style="color: #5317ac;">if</span> (<span style="color: #8f0075;">$_</span>) {
      <span style="color: #00538b;">$link</span> = <span style="color: #00538b;">$obj</span>.CreateShortcut(<span style="color: #8f0075;">$_</span>.FullName)

      <span style="color: #00538b;">$info</span> = @{}
      <span style="color: #00538b;">$info</span>.Hotkey = <span style="color: #00538b;">$link</span>.Hotkey
      <span style="color: #00538b;">$info</span>.TargetPath = <span style="color: #00538b;">$link</span>.TargetPath
      <span style="color: #00538b;">$info</span>.LinkPath = <span style="color: #00538b;">$link</span>.FullName
      <span style="color: #00538b;">$info</span>.Arguments = <span style="color: #00538b;">$link</span>.Arguments
      <span style="color: #00538b;">$info</span>.Target = <span style="color: #5317ac;">try</span> {<span style="color: #721045;">Split-Path</span> <span style="color: #00538b;">$info</span>.TargetPath <span style="color: #0000c0;">-Leaf</span> } <span style="color: #5317ac;">catch</span> { <span style="color: #2544bb;">'n/a'</span>}
      <span style="color: #00538b;">$info</span>.Link = <span style="color: #5317ac;">try</span> { <span style="color: #721045;">Split-Path</span> <span style="color: #00538b;">$info</span>.LinkPath <span style="color: #0000c0;">-Leaf</span> } <span style="color: #5317ac;">catch</span> { <span style="color: #2544bb;">'n/a'</span>}
      <span style="color: #00538b;">$info</span>.WindowStyle = <span style="color: #00538b;">$link</span>.WindowStyle
      <span style="color: #00538b;">$info</span>.IconLocation = <span style="color: #00538b;">$link</span>.IconLocation

      <span style="color: #721045;">New-Object</span> PSObject <span style="color: #0000c0;">-Property</span> <span style="color: #00538b;">$info</span>
    }
  }
}
<span style="color: #5317ac;">function</span> <span style="color: #721045;">Set-Shortcut</span> {
  <span style="color: #5317ac;">param</span>(
  [Parameter(ValueFromPipelineByPropertyName=<span style="color: #8f0075;">$true</span>)]
  <span style="color: #00538b;">$LinkPath</span>,
  <span style="color: #00538b;">$Hotkey</span>,
  <span style="color: #00538b;">$IconLocation</span>,
  <span style="color: #00538b;">$Arguments</span>,
  <span style="color: #00538b;">$TargetPath</span>
  )
  <span style="color: #5317ac;">begin</span> {
    <span style="color: #00538b;">$shell</span> = <span style="color: #721045;">New-Object</span> <span style="color: #0000c0;">-ComObject</span> WScript.Shell
  }
  <span style="color: #5317ac;">process</span> {
    <span style="color: #00538b;">$link</span> = <span style="color: #00538b;">$shell</span>.CreateShortcut(<span style="color: #00538b;">$LinkPath</span>)

    <span style="color: #8f0075;">$PSCmdlet</span>.MyInvocation.BoundParameters.GetEnumerator() |
      <span style="color: #721045;">Where-Object</span> { <span style="color: #8f0075;">$_</span>.key <span style="color: #8f0075;">-ne</span> <span style="color: #2544bb;">'LinkPath'</span> } |
      <span style="color: #721045;">ForEach-Object</span> { <span style="color: #00538b;">$link</span>.$(<span style="color: #8f0075;">$_</span>.key) = <span style="color: #8f0075;">$_</span>.value }
    <span style="color: #00538b;">$link</span>.Save()
  }
}

</pre>
</div>

<p>
We use it here to create a file that runs our AutoHotkey scripts on startup:
</p>

<div class="org-src-container">
<pre class="src src-powershell"><span style="color: #00538b;">$userEnv</span>     = <span style="color: #00538b;">$</span><span style="color: #005a5f; text-decoration: underline;">ENV</span><span style="color: #00538b;">:UserProfile</span>
<span style="color: #00538b;">$appData</span>     = <span style="color: #2544bb;">"\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup"</span>
<span style="color: #00538b;">$startupPath</span> = <span style="color: #2544bb;">"$userEnv$appData"</span>
<span style="color: #721045;">Set-Shortcut</span> <span style="color: #0000c0;">-LinkPath</span> <span style="color: #2544bb;">"$startupPath\general.ahk.lnk"</span> <span style="color: #0000c0;">-TargetPath</span> <span style="color: #2544bb;">"C:\cmd\ahk\general.ahk"</span>
<span style="color: #721045;">Set-Shortcut</span> <span style="color: #0000c0;">-LinkPath</span> <span style="color: #2544bb;">"$startupPath\spooler.ahk.lnk"</span> <span style="color: #0000c0;">-TargetPath</span> <span style="color: #2544bb;">"C:\cmd\ahk\spooler.ahk"</span>
<span style="color: #721045;">Set-Shortcut</span> <span style="color: #0000c0;">-LinkPath</span> <span style="color: #2544bb;">"$startupPath\printer.ahk.lnk"</span> <span style="color: #0000c0;">-TargetPath</span> <span style="color: #2544bb;">"C:\cmd\ahk\printer.ahk"</span>
</pre>
</div>

<p>
This is a function that returns human readable numbers. This could almost certainly be refactored, but I just wanted to get something working quickly to get my background image script working nicely:
</p>

<div class="org-src-container">
<pre class="src src-powershell">
<span style="color: #5317ac;">function</span> <span style="color: #721045;">Readable-Numbers</span>(<span style="color: #00538b;">$InputNumber</span>,<span style="color: #00538b;">$NumberFormat</span>) 
{
    <span style="color: #5317ac;">function</span> <span style="color: #721045;">One-Digit</span>(<span style="color: #00538b;">$in</span>) 
    {
        <span style="color: #5317ac;">switch</span> ( <span style="color: #00538b;">$in</span>.Substring(<span style="color: #00538b;">$in</span>.Length - 1) )
        {
            0 { 
                <span style="color: #5317ac;">if</span> (<span style="color: #00538b;">$in</span>.Length <span style="color: #8f0075;">-eq</span> 1) 
                {
                    <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Zero"</span> 
                }
                <span style="color: #5317ac;">else</span>
                {
                    <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">""</span>
                }
            }
            1 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"One"</span> }
            2 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Two"</span> }
            3 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Three"</span> }
            4 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Four"</span> }
            5 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Five"</span> }
            6 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Six"</span> }
            7 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Seven"</span> }
            8 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Eight"</span> }
            9 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Nine"</span> }
        }
        <span style="color: #5317ac;">return</span> <span style="color: #00538b;">$ReadableNumber</span>
    }
    <span style="color: #5317ac;">function</span> <span style="color: #721045;">Two-Digit</span>(<span style="color: #00538b;">$in</span>) 
    {
        <span style="color: #5317ac;">switch</span> <span style="color: #8f0075;">-Wildcard</span> ( <span style="color: #00538b;">$in</span> )
        {
            10 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Ten"</span> }
            11 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Eleven"</span> }
            12 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Twelve"</span> }
            13 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Thirteen"</span> }
            14 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Fourteen"</span> }
            15 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Fifteen"</span> }
            16 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Sixteen"</span> }
            17 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Seventeen"</span> }
            18 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Eighteen"</span> }
            19 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Nineteen"</span> }
            <span style="color: #2544bb;">"[2-9][0-9]"</span> 
            { 
                <span style="color: #00538b;">$i</span> = <span style="color: #8f0075;">$_</span>.ToCharArray()
                <span style="color: #00538b;">$i1</span> = <span style="color: #00538b;">$i</span>[0]
                <span style="color: #00538b;">$i2</span> = <span style="color: #00538b;">$i</span>[1]
                <span style="color: #5317ac;">switch</span> ( <span style="color: #00538b;">$i1</span> ) 
                {
                    2 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Twenty"</span> }
                    3 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Thirty"</span> }
                    4 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Forty"</span> }
                    5 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Fifty"</span> }
                    6 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Sixty"</span> }
                    7 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Seventy"</span> }
                    8 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Eighty"</span> }
                    9 { <span style="color: #00538b;">$ReadableNumber</span> = <span style="color: #2544bb;">"Ninety"</span> }
                }
                <span style="color: #5317ac;">if</span> (<span style="color: #2544bb;">"$i2"</span> <span style="color: #8f0075;">-ne</span> <span style="color: #2544bb;">"0"</span>)
                {
                    <span style="color: #00538b;">$ReadableNumber</span> += <span style="color: #2544bb;">"-"</span>
                }
                <span style="color: #00538b;">$ReadableNumber</span> += <span style="color: #721045;">One-Digit</span>(<span style="color: #8f0075;">$_</span>)
            }
        }
        <span style="color: #5317ac;">return</span> <span style="color: #00538b;">$ReadableNumber</span>
    }
    <span style="color: #00538b;">$in</span> = <span style="color: #00538b;">$InputNumber</span>.ToString()
    <span style="color: #5317ac;">switch</span> ( <span style="color: #00538b;">$in</span>.Length )
    {
        1 {
            <span style="color: #721045;">One-Digit</span>(<span style="color: #00538b;">$in</span>)
        }
        2 {
            <span style="color: #721045;">Two-Digit</span>(<span style="color: #00538b;">$in</span>)
        }
        <span style="color: #5317ac;">default</span> {
            <span style="color: #5317ac;">return</span> <span style="color: #2544bb;">""</span>
        }
    }
}
</pre>
</div>

<p>
And finally, we set some quick shortcuts to use whilst navigating folders in the terminal. After that, we make sure we start in the user home, otherwise Powershell will open up in the folder we're in now (<code>C:/cmd</code>). 
</p>

<div class="org-src-container">
<pre class="src src-powershell">
<span style="color: #5317ac;">function</span> dev { cd C:\CMD }
<span style="color: #5317ac;">function</span> home { cd ~ }
<span style="color: #5317ac;">function</span> ll { ls }
<span style="color: #5317ac;">function</span> uk { cd <span style="color: #2544bb;">"~\Documents\Website\2) UK Site\"</span> }
<span style="color: #5317ac;">function</span> us { cd <span style="color: #2544bb;">"~\Documents\Website\3) Export\US Site"</span> }
<span style="color: #5317ac;">function</span> ca { cd <span style="color: #2544bb;">"~\Documents\Website\3) Export\CA Site"</span> }
<span style="color: #5317ac;">function</span> eu { cd <span style="color: #2544bb;">"~\Documents\Website\3) Export\EU Site"</span> } 

cd <span style="color: #00538b;">$</span><span style="color: #005a5f; text-decoration: underline;">env</span><span style="color: #00538b;">:userprofile</span>

</pre>
</div>

<p>
The nasty thing about this is that the Powershell File needs to be in a diffent path to the one we specify in this script. I don't know exactly why I've done it like this.
</p>

<p>
Use this to update the script:
</p>

<div class="org-src-container">
<pre class="src src-powershell">cp C:\cmd\ps\psrc.ps1 <span style="color: #8f0075;">$home</span>\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1
</pre>
</div>
</div>
</div>

<div id="outline-container-orgece09be" class="outline-3">
<h3 id="orgece09be">'Email' Scripts</h3>
<div class="outline-text-3" id="text-orgece09be">
<p>
This is a Powershell function for sending outlook mail objects.
</p>

<div class="org-src-container">
<pre class="src src-powershell"><span style="color: #505050;">#!/c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe -File</span>

<span style="color: #5317ac;">function</span> Send-Outlook-Email {
    <span style="color: #5317ac;">param</span> (
        <span style="color: #00538b;">$Subject</span>,
        <span style="color: #00538b;">$Body</span>
    )
    <span style="color: #505050;"># Outlook ComObject</span>
    <span style="color: #00538b;">$outlook</span> = <span style="color: #721045;">New-Object</span> <span style="color: #0000c0;">-ComObject</span> Outlook.Application
    <span style="color: #00538b;">$outlookMail</span> = <span style="color: #00538b;">$outlook</span>.CreateItem(0)
    <span style="color: #505050;"># Mail Content</span>
    <span style="color: #00538b;">$outlookMail</span>.To = <span style="color: #2544bb;">"EMAIL@EMAIL.EMAIL"</span> 
    <span style="color: #00538b;">$outlookMail</span>.Subject = <span style="color: #2544bb;">"$Subject"</span> 
    <span style="color: #00538b;">$outlookMail</span>.Body = <span style="color: #2544bb;">"$Body"</span>
    <span style="color: #00538b;">$outlookMail</span>.SentOnBehalfOf = <span style="color: #2544bb;">"Test"</span>
    <span style="color: #00538b;">$outlookMail</span>.Send()
    <span style="color: #721045;">Write-Host</span> <span style="color: #2544bb;">"Email Sent"</span>
    <span style="color: #721045;">Start-Sleep</span> 2
    <span style="color: #505050;">## Don't Quit Outlook, I might be using it...</span>
}

Send-Outlook-Email <span style="color: #0000c0;">-Subject</span> <span style="color: #8f0075;">$args</span>[0] <span style="color: #0000c0;">-Body</span> <span style="color: #8f0075;">$args</span>[1]

</pre>
</div>

<p>
This could <i>probably</i> be put in the Powershell configuration file too, but I'm keeping it round mainly as a helper script when writing stuff.
</p>

<p>
Here's a rough-and-ready script that makes use of it:
</p>

<div class="org-src-container">
<pre class="src src-powershell"><span style="color: #505050;">#!/c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe -File</span>

<span style="color: #505050;"># Could use [mandatory]?</span>
<span style="color: #5317ac;">Param</span> (
    <span style="color: #00538b;">$EndTime</span>,
    <span style="color: #00538b;">$Interval</span>,
    <span style="color: #00538b;">$Recipient</span>,
    <span style="color: #00538b;">$Description</span>
) 

<span style="color: #5317ac;">Function</span> Send-Outlook-Email {
    <span style="color: #5317ac;">Param</span> (
        <span style="color: #00538b;">$To</span>,
        <span style="color: #00538b;">$Subject</span>,
        <span style="color: #00538b;">$Body</span>
    )

    <span style="color: #00538b;">$outlook</span> = <span style="color: #721045;">New-Object</span> <span style="color: #0000c0;">-ComObject</span> Outlook.Application
    <span style="color: #00538b;">$outlookMail</span> = <span style="color: #00538b;">$outlook</span>.CreateItem(0)

    <span style="color: #00538b;">$outlookMail</span>.To = <span style="color: #2544bb;">"$To"</span> 
    <span style="color: #00538b;">$outlookMail</span>.Subject = <span style="color: #2544bb;">"$Subject"</span> 
    <span style="color: #00538b;">$outlookMail</span>.Body = <span style="color: #2544bb;">"$Body"</span>
    <span style="color: #00538b;">$outlookMail</span>.Send()
    <span style="color: #00538b;">$timestamp</span> = <span style="color: #721045;">Get-Date</span> <span style="color: #0000c0;">-Format</span> HH:mm
    <span style="color: #721045;">Write-Host</span> <span style="color: #2544bb;">"Sent email to $To at $timestamp."</span>
    <span style="color: #721045;">Start-Sleep</span> 2
}

<span style="color: #5317ac;">Function</span> <span style="color: #721045;">Script-Usage</span> {
    <span style="color: #721045;">Write-Host</span> <span style="color: #2544bb;">"This script requires the following arguments:"</span>
    <span style="color: #721045;">Write-Host</span> <span style="color: #2544bb;">"  -EndTime     =&gt;  Time till countdown end"</span>
    <span style="color: #721045;">Write-Host</span> <span style="color: #2544bb;">"  -Interval    =&gt;  Countdown interval (seconds)"</span>
    <span style="color: #721045;">Write-Host</span> <span style="color: #2544bb;">"  -Recipient   =&gt;  Recipient(s), semi-colon for multiple`r`n"</span>
    <span style="color: #721045;">Write-Host</span> <span style="color: #2544bb;">"Optional:"</span>
    <span style="color: #721045;">Write-Host</span> <span style="color: #2544bb;">"  -Description =&gt;  Event description string"</span>
    <span style="color: #5317ac;">Exit</span>
}

<span style="color: #505050;">#########################</span>

<span style="color: #5317ac;">If</span> (<span style="color: #8f0075;">-Not</span> (<span style="color: #00538b;">$EndTime</span>))   { <span style="color: #5317ac;">Throw</span> <span style="color: #2544bb;">"`r`nError: EndTime is required`r`n"</span> }
<span style="color: #5317ac;">If</span> (<span style="color: #8f0075;">-Not</span> (<span style="color: #00538b;">$Interval</span>))  { <span style="color: #5317ac;">Throw</span> <span style="color: #2544bb;">"`r`nError: Interval is required`r`n"</span> }
<span style="color: #5317ac;">If</span> (<span style="color: #8f0075;">-Not</span> (<span style="color: #00538b;">$Recipient</span>)) { <span style="color: #5317ac;">Throw</span> <span style="color: #2544bb;">"`r`nError: Recipient is required`r`n"</span> }

<span style="color: #5317ac;">If</span> (<span style="color: #00538b;">$Description</span> <span style="color: #8f0075;">-ne</span> <span style="color: #2544bb;">""</span>)
{
    <span style="color: #00538b;">$Description</span> = <span style="color: #2544bb;">": $Description"</span>
    <span style="color: #00538b;">$descriptionBody</span> = <span style="color: #2544bb;">"This reminder is about$Description"</span>
}

<span style="color: #00538b;">$endTimeFormatted</span> = (<span style="color: #721045;">Get-Date</span> <span style="color: #00538b;">$EndTime</span> <span style="color: #0000c0;">-Format</span> HH:mm:ss)

<span style="color: #5317ac;">While</span> (<span style="color: #8f0075;">$true</span>) 
{
    <span style="color: #00538b;">$currentTime</span> = <span style="color: #721045;">Get-Date</span> <span style="color: #0000c0;">-Format</span> HH:mm:ss

    <span style="color: #00538b;">$timeRemaining</span> = <span style="color: #005a5f;">[math]</span>::Round((<span style="color: #721045;">New-TimeSpan</span> <span style="color: #0000c0;">-Start</span> <span style="color: #00538b;">$currentTime</span> <span style="color: #8f0075;">-End</span> <span style="color: #00538b;">$endTimeFormatted</span>).TotalMinutes)
    <span style="color: #00538b;">$timeRemaining</span> = <span style="color: #2544bb;">"$timeRemaining minutes to go"</span>

    <span style="color: #00538b;">$subject</span> = <span style="color: #2544bb;">"Upcoming ($timeRemaining) Reminder$Description"</span>
    <span style="color: #00538b;">$body</span> = @<span style="color: #2544bb;">"</span>
<span style="color: #2544bb;">Hello there,</span>

<span style="color: #2544bb;">You have $timeRemaining! $descriptionBody</span>

<span style="color: #2544bb;">This message is due to send every $Interval seconds...</span>

<span style="color: #2544bb;">Kind regards,</span>
<span style="color: #2544bb;">"@</span>

    <span style="color: #505050;"># Mail Sending Call</span>
    <span style="color: #5317ac;">Try</span>
    {
        Send-Outlook-Email <span style="color: #0000c0;">-To</span> <span style="color: #00538b;">$Recipient</span> <span style="color: #0000c0;">-Subject</span> <span style="color: #00538b;">$subject</span> <span style="color: #0000c0;">-Body</span> <span style="color: #00538b;">$body</span>
    }
    <span style="color: #5317ac;">Catch</span>
    {
        <span style="color: #721045;">Write-Host</span> <span style="color: #2544bb;">"Unable to send email (for some reason), to $Recipient. Please try again."</span>
        <span style="color: #5317ac;">Exit</span>
    }
    <span style="color: #5317ac;">If</span> ((<span style="color: #721045;">Get-Date</span>) <span style="color: #8f0075;">-gt</span> (<span style="color: #721045;">Get-Date</span> <span style="color: #00538b;">$EndTime</span>))
    {
        <span style="color: #721045;">Write-Host</span> <span style="color: #2544bb;">"Script has finished notifying its victi- ...recipient!"</span>
        <span style="color: #5317ac;">Break</span>
    }
    <span style="color: #5317ac;">Else</span>
    {
        <span style="color: #721045;">Start-Sleep</span> <span style="color: #0000c0;">-Seconds</span> <span style="color: #00538b;">$Interval</span>
    }
}
</pre>
</div>
</div>

<div id="outline-container-orgce805fb" class="outline-4">
<h4 id="orgce805fb"><span class="done DONE">DONE</span> Should use argument flags instead of by order</h4>
</div>
<div id="outline-container-org53c96a4" class="outline-4">
<h4 id="org53c96a4"><span class="todo TODO">TODO</span> General cleanup of this script</h4>
</div>
<div id="outline-container-org32830d6" class="outline-4">
<h4 id="org32830d6"><span class="todo TODO">TODO</span> Improve Param()</h4>
<div class="outline-text-4" id="text-org32830d6">
</div>
<ul class="org-ul">
<li><a id="org1be3083"></a><span class="todo TODO">TODO</span> I've not really played around with <code>Param</code> too much, but from the looks of things I should be able to use <code>[Mandatory]</code> in the Param section.<br /></li>
<li><a id="org7dfa3b0"></a><span class="todo TODO">TODO</span> Use <code>Param</code> to sort out the types going on (set <code>[Date]</code>, etc.)<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org70774b5" class="outline-3">
<h3 id="org70774b5">Fonts</h3>
<div class="outline-text-3" id="text-org70774b5">
<p>
I want to improve this part, at some point. The fonts I use are:
</p>

<ul class="org-ul">
<li><a href="https://github.com/ryanoasis/nerd-fonts/tree/master/patched-fonts/AnonymousPro">Anonymice NF</a></li>
<li><a href="https://github.com/tonsky/FiraCode">Fira Code Retina</a>
<ul class="org-ul">
<li>Plus a <a href="https://github.com/zwaldowski/Fira/tree/zwaldowski/mod-new/otf">patched version</a> with the monospace <i>italics</i></li>
</ul></li>
<li><del><a href="https://github.com/edwardtufte/et-book">ET Book Open Type</a></del> (don't use this in my Org documents anymore)</li>
</ul>

<div class="org-src-container">
<pre class="src src-powershell">
<span style="color: #00538b;">$fontArray</span> = @(

    @(<span style="color: #2544bb;">"Anonymice Nerd Font Complete Windows Compatible.ttf"</span>,<span style="color: #2544bb;">"https://github.com/ryanoasis/nerd-fonts/raw/master/patched-fonts/AnonymousPro/complete/Anonymice%20Nerd%20Font%20Complete%20Windows%20Compatible.ttf"</span>),
    @(<span style="color: #2544bb;">"FiraCode-VF.ttf"</span>,<span style="color: #2544bb;">"https://github.com/tonsky/FiraCode/releases/download/6.2/Fira_Code_v6.2.zip"</span>),
    @(<span style="color: #2544bb;">"FiraMono-MediumItalic.otf"</span>,<span style="color: #2544bb;">"https://github.com/zwaldowski/Fira/raw/zwaldowski/mod-new/otf/FiraMono-MediumItalic.otf"</span>)

)

<span style="color: #5317ac;">ForEach</span> (<span style="color: #00538b;">$font</span> <span style="color: #5317ac;">In</span> <span style="color: #00538b;">$fontArray</span>) {

    <span style="color: #00538b;">$fontName</span> = <span style="color: #00538b;">$font</span>[0]
    <span style="color: #00538b;">$fontURL</span>  = <span style="color: #00538b;">$font</span>[1]
    <span style="color: #00538b;">$fontDownloadLocation</span> = <span style="color: #2544bb;">"$env:TEMP\$fontName"</span>

    <span style="color: #721045;">Write-Host</span> <span style="color: #2544bb;">"Installing: $fontName"</span>

    <span style="color: #5317ac;">If</span> (<span style="color: #005a5f;">[IO.Path]</span>::GetExtension(<span style="color: #00538b;">$fontURL</span>) <span style="color: #8f0075;">-eq</span> <span style="color: #2544bb;">'.zip'</span>) {
        <span style="color: #505050;">## Extract a zip file first</span>
        <span style="color: #5317ac;">Try</span> { 
            <span style="color: #00538b;">$fontArchive</span>=<span style="color: #2544bb;">"$env:TEMP\font-install-temp.zip"</span>
            (<span style="color: #721045;">New-Object</span> System.Net.WebClient).DownloadFile(<span style="color: #00538b;">$fontURL</span>,<span style="color: #00538b;">$fontArchive</span>)
        } <span style="color: #5317ac;">Catch</span> {
            <span style="color: #721045;">Write-Host</span> <span style="color: #2544bb;">"! Error downloading $fontURL"</span>
        }
        <span style="color: #721045;">Expand-Archive</span> <span style="color: #00538b;">$fontArchive</span> <span style="color: #0000c0;">-Force</span>
        (<span style="color: #721045;">New-Object</span> <span style="color: #0000c0;">-comObject</span> Shell.Application).Namespace(0x14).CopyHere((<span style="color: #721045;">Get-ChildItem</span> <span style="color: #0000c0;">-Path</span> <span style="color: #2544bb;">"$env:TEMP\font-install-temp"</span> <span style="color: #0000c0;">-Include</span> <span style="color: #00538b;">$fontName</span> <span style="color: #0000c0;">-File</span> <span style="color: #0000c0;">-Recurse</span>).FullName,0x10)
        <span style="color: #721045;">Remove-Item</span> <span style="color: #2544bb;">"$env:TEMP\font-install-temp*"</span> <span style="color: #0000c0;">-Force</span> <span style="color: #0000c0;">-Recurse</span>

    } <span style="color: #5317ac;">Else</span> {
        <span style="color: #505050;">## Just installing a font file</span>
        <span style="color: #5317ac;">Try</span> {
            (<span style="color: #721045;">New-Object</span> System.Net.WebClient).DownloadFile(<span style="color: #00538b;">$fontURL</span>,<span style="color: #00538b;">$fontDownloadLocation</span>)
        } <span style="color: #5317ac;">Catch</span> {
            <span style="color: #721045;">Write-Host</span> <span style="color: #2544bb;">"! Error downloading $fontURL"</span>
        }
        (<span style="color: #721045;">New-Object</span> <span style="color: #0000c0;">-comObject</span> Shell.Application).Namespace(0x14).CopyHere(<span style="color: #00538b;">$fontDownloadLocation</span>,0x10)
        <span style="color: #721045;">Remove-Item</span> <span style="color: #00538b;">$fontDownloadLocation</span> <span style="color: #0000c0;">-Force</span>

    } 

}

</pre>
</div>
</div>

<div id="outline-container-org88f4c6d" class="outline-4">
<h4 id="org88f4c6d"><span class="todo TODO">TODO</span> Refactor this at some point</h4>
<div class="outline-text-4" id="text-org88f4c6d">
<p>
<b>This is untest on a new system without all these fonts installed.</b>
</p>
</div>
</div>
</div>
</div>


<div id="outline-container-orgf80829c" class="outline-2">
<h2 id="orgf80829c">AutoHotkey</h2>
<div class="outline-text-2" id="text-orgf80829c">
</div>
<div id="outline-container-org53df033" class="outline-3">
<h3 id="org53df033">About</h3>
<div class="outline-text-3" id="text-org53df033">
<p>
It's nice to have a reminder like this, when writing these AutoHotkey scripts:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Char</th>
<th scope="col" class="org-left">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>#</code></td>
<td class="org-left">windows key</td>
</tr>

<tr>
<td class="org-left"><code>!</code></td>
<td class="org-left">alt key</td>
</tr>

<tr>
<td class="org-left"><code>^</code></td>
<td class="org-left">ctrl key</td>
</tr>

<tr>
<td class="org-left"><code>+</code></td>
<td class="org-left">shift key</td>
</tr>

<tr>
<td class="org-left"><code>*</code></td>
<td class="org-left">wildcard</td>
</tr>

<tr>
<td class="org-left"><code>~</code></td>
<td class="org-left">pass-through char</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgf8f1714" class="outline-3">
<h3 id="orgf8f1714">Essentials</h3>
<div class="outline-text-3" id="text-orgf8f1714">
<p>
These are my absolute essential AutoHotkey bindings for productivity on Windows 10: 
</p>

<div class="org-src-container">
<pre class="src src-ahk">
<span style="color: #505050;">; </span><span style="color: #505050;">"Alt + Spacebar", Toggles Window 'Always on top' status</span>
<span style="color: #0000c0;">^SPACE</span>::  <span style="color: #5317ac;">Winset</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Alwaysontop</span><span style="color: #8f0075;">,</span> <span style="color: #8f0075;">,</span> A

<span style="color: #505050;">; </span><span style="color: #505050;">Add Sound to Volume Keys</span>
<span style="color: #0000c0;">~Volume_Up</span>::
<span style="color: #0000c0;">~Volume_Down</span>::
<span style="color: #5317ac;">SoundPlay</span><span style="color: #8f0075;">,</span> C:\cmd\ahk\res\bing<span style="color: #8f0075;">-</span>1<span style="color: #8f0075;">.</span>wav
<span style="color: #813e00;">Return</span>

<span style="color: #505050;">; </span><span style="color: #505050;">"Alt + q", to close current window</span>
<span style="color: #0000c0;">!q</span>::
<span style="color: #5317ac;">WinGetActiveTitle</span><span style="color: #8f0075;">,</span> OutputVar
<span style="color: #5317ac;">WinKill</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%OutputVar%</span>
<span style="color: #813e00;">Return</span>

<span style="color: #505050;">; </span><span style="color: #505050;">"Alt + Enter", to run CMDrc</span>
#IfWinNotActive<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">ahk_class</span> Microsoft Excel
<span style="color: #0000c0;">!Enter</span>:: <span style="color: #5317ac;">Run</span><span style="color: #8f0075;">,</span> <span style="color: #2544bb;">"C:\cmd\cmdrc.bat"</span>

<span style="color: #505050;">; </span><span style="color: #505050;">"Win + Enter", to run Powershell</span>
<span style="color: #0000c0;">#Enter</span>:: <span style="color: #5317ac;">Run</span><span style="color: #8f0075;">,</span> <span style="color: #2544bb;">"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe"</span>

<span style="color: #505050;">; </span><span style="color: #505050;">"Win + Alt + Enter", to Run Git Bash</span>
<span style="color: #0000c0;">#!Enter</span>:: <span style="color: #5317ac;">Run</span><span style="color: #8f0075;">,</span> <span style="color: #2544bb;">"C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Git\Git Bash"</span>

<span style="color: #505050;">; </span><span style="color: #505050;">"Alt + F", to Run Firefox</span>
<span style="color: #0000c0;">!f</span>::<span style="color: #5317ac;">Run</span><span style="color: #8f0075;">,</span> <span style="color: #2544bb;">"C:\Program Files\Mozilla Firefox\firefox.exe"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org2a77206" class="outline-3">
<h3 id="org2a77206">Snipping Tools</h3>
<div class="outline-text-3" id="text-org2a77206">
<p>
I use snipping tool, and these two little hotkeys are very useful to annotate your snips. With <code>Alt + u</code>, you can click two locations on your screen and it'll draw a line between them, with snipping tool, and with <code>Alt + b</code>, it draws a square box between two points.
</p>

<div class="org-src-container">
<pre class="src src-ahk">
<span style="color: #505050;">;; </span><span style="color: #505050;">Snipping Tools</span>
<span style="color: #0000c0;">$PrintScreen</span>::
<span style="color: #5317ac;">Run</span><span style="color: #8f0075;">,</span> <span style="color: #2544bb;">"C:\Windows\system32\SnippingTool.exe"</span>
<span style="color: #5317ac;">WinWait</span><span style="color: #8f0075;">,</span> Snipping Tool<span style="color: #8f0075;">,,</span> 10
<span style="color: #5317ac;">If</span> <span style="color: #00538b;">ErrorLevel</span>
{
        <span style="color: #5317ac;">MsgBox</span><span style="color: #8f0075;">,</span> <span style="color: #2544bb;">"Snipping tool did not open as expected."</span>
}
<span style="color: #5317ac;">Else</span>
{
        <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> {<span style="color: #0000c0;">ctrl</span> <span style="color: #0000c0;">down</span>}{n <span style="color: #0000c0;">down</span>}
        <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> {<span style="color: #0000c0;">ctrl</span> <span style="color: #0000c0;">up</span>}{n <span style="color: #0000c0;">up</span>}
}
<span style="color: #813e00;">Return</span>

<span style="color: #505050;">; </span><span style="color: #505050;">Alt + U (U for Underline)</span>
<span style="color: #0000c0;">!u</span>::
<span style="color: #5317ac;">KeyWait</span><span style="color: #8f0075;">,</span> <span style="color: #0000c0;">LButton</span><span style="color: #8f0075;">,</span> D
<span style="color: #5317ac;">MouseGetPos</span><span style="color: #8f0075;">,</span> X1<span style="color: #8f0075;">,</span> Y1
<span style="color: #5317ac;">KeyWait</span><span style="color: #8f0075;">,</span> <span style="color: #0000c0;">LButton</span><span style="color: #8f0075;">,</span> U
<span style="color: #5317ac;">KeyWait</span><span style="color: #8f0075;">,</span> <span style="color: #0000c0;">LButton</span><span style="color: #8f0075;">,</span> D
<span style="color: #5317ac;">MouseGetPos</span><span style="color: #8f0075;">,</span> X2<span style="color: #8f0075;">,</span> Y2
<span style="color: #5317ac;">MouseClickDrag</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">left</span><span style="color: #8f0075;">,</span> X1<span style="color: #8f0075;">,</span> Y1<span style="color: #8f0075;">,</span> X2<span style="color: #8f0075;">,</span> Y2
<span style="color: #813e00;">Return</span>

<span style="color: #505050;">; </span><span style="color: #505050;">Alt + B (B for Box)</span>
<span style="color: #0000c0;">!b</span>::
<span style="color: #5317ac;">KeyWait</span><span style="color: #8f0075;">,</span> <span style="color: #0000c0;">LButton</span><span style="color: #8f0075;">,</span> D
<span style="color: #5317ac;">MouseGetPos</span><span style="color: #8f0075;">,</span> X1<span style="color: #8f0075;">,</span> Y1
<span style="color: #5317ac;">KeyWait</span><span style="color: #8f0075;">,</span> <span style="color: #0000c0;">LButton</span><span style="color: #8f0075;">,</span> U
<span style="color: #5317ac;">KeyWait</span><span style="color: #8f0075;">,</span> <span style="color: #0000c0;">LButton</span><span style="color: #8f0075;">,</span> D
<span style="color: #5317ac;">MouseGetPos</span><span style="color: #8f0075;">,</span> X4<span style="color: #8f0075;">,</span> Y4
<span style="color: #5317ac;">MouseClickDrag</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">left</span><span style="color: #8f0075;">,</span> X4<span style="color: #8f0075;">,</span> Y1<span style="color: #8f0075;">,</span> X1<span style="color: #8f0075;">,</span> Y1
<span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 200
<span style="color: #5317ac;">MouseClickDrag</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">left</span><span style="color: #8f0075;">,</span> X1<span style="color: #8f0075;">,</span> Y1<span style="color: #8f0075;">,</span> X1<span style="color: #8f0075;">,</span> Y4
<span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 200
<span style="color: #5317ac;">MouseClickDrag</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">left</span><span style="color: #8f0075;">,</span> X1<span style="color: #8f0075;">,</span> Y4<span style="color: #8f0075;">,</span> X4<span style="color: #8f0075;">,</span> Y4
<span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 200
<span style="color: #5317ac;">MouseClickDrag</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">left</span><span style="color: #8f0075;">,</span> X4<span style="color: #8f0075;">,</span> Y1<span style="color: #8f0075;">,</span> X4<span style="color: #8f0075;">,</span> Y4
<span style="color: #813e00;">Return</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orgdddf52e" class="outline-3">
<h3 id="orgdddf52e">Lines and Symbols</h3>
<div class="outline-text-3" id="text-orgdddf52e">
<p>
This is a collection of pre-drawn linebreaks for any plaintext files I may be working on: 
</p>

<div class="org-src-container">
<pre class="src src-ahk">
<span style="color: #505050;">; </span><span style="color: #505050;">Line Break / &lt;hr&gt;'s - - - - - - - - - - - - - - -</span>

<span style="color: #505050;">; </span><span style="color: #505050;">= Insert  -+-  -+-  -+-  -+-  -+-  -+-  -+-  -+-</span>
<span style="color: #8f0075;">!=</span>::
<span style="color: #5317ac;">Loop</span><span style="color: #8f0075;">,</span> 8
{
        <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> {<span style="color: #0000c0;">space</span>}<span style="color: #8f0075;">-</span>{<span style="color: #8f0075;">+</span>}<span style="color: #8f0075;">-</span>{<span style="color: #0000c0;">space</span>}
}
<span style="color: #813e00;">Return</span>

<span style="color: #505050;">; </span><span style="color: #505050;">~ Insert -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-</span>
<span style="color: #0000c0;">!#</span>::
<span style="color: #5317ac;">Loop</span><span style="color: #8f0075;">,</span> 16
{
        <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #8f0075;">-~</span>
}
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #8f0075;">-</span>
<span style="color: #813e00;">Return</span>

<span style="color: #505050;">; </span><span style="color: #505050;">Indented non-markdown-ish "o - "</span>
<span style="color: #0000c0;">!-</span>::
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> {<span style="color: #0000c0;">space</span>}o{<span style="color: #0000c0;">space</span>}<span style="color: #8f0075;">-</span>{<span style="color: #0000c0;">space</span>}
<span style="color: #813e00;">Return</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org33f7811" class="outline-3">
<h3 id="org33f7811">Instagram Hashtags</h3>
<div class="outline-text-3" id="text-org33f7811">
<p>
This one inserts a series of hashtags for the Instagram business account I run: 
</p>

<div class="org-src-container">
<pre class="src src-ahk">
<span style="color: #0000c0;">#!i</span>::
<span style="color: #5317ac;">FileRead</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">Clipboard</span><span style="color: #8f0075;">,</span> C:\cmd\ahk\res\wt<span style="color: #8f0075;">.</span>txt
<span style="color: #5317ac;">Clipwait</span><span style="color: #8f0075;">,</span> 1
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%clipboard%</span>
<span style="color: #00538b;">Clipboard</span><span style="color: #8f0075;">:=</span><span style="color: #2544bb;">""</span>
<span style="color: #813e00;">Return</span>

</pre>
</div>

<p>
And the hashtags are&#x2026;
</p>

<div class="org-src-container">
<pre class="src src-text">{#}mobility {#}accessibility {#}disability {#}independence {#}movement {#}company {#}office {#}career {#}living {#}decor {#}modern {#}interior {#}instadecor {#}architecture {#}cities {#}town {#}local {#}building {#}construction {#}house 
</pre>
</div>
</div>
</div>

<div id="outline-container-org88c5c0f" class="outline-3">
<h3 id="org88c5c0f">Timestamps</h3>
<div class="outline-text-3" id="text-org88c5c0f">
<p>
Here are some timestamp keys, bound to <code>Alt + FX</code>:
</p>

<div class="org-src-container">
<pre class="src src-ahk">
<span style="color: #505050;">; </span><span style="color: #505050;">F5 Insert Timestamp</span>
<span style="color: #0000c0;">!F5</span>::
<span style="color: #5317ac;">FormatTime</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">time</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">A_now</span><span style="color: #8f0075;">,</span> ddd d<span style="color: #8f0075;">-</span>MMM<span style="color: #8f0075;">-</span>yy hh:mm tt
<span style="color: #5317ac;">send</span> <span style="color: #00538b;">%time%</span>
<span style="color: #813e00;">Return</span>

<span style="color: #505050;">; </span><span style="color: #505050;">F6 Insert Time</span>
<span style="color: #0000c0;">!F6</span>::
<span style="color: #5317ac;">FormatTime</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">time</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">A_now</span><span style="color: #8f0075;">,</span> ddd d<span style="color: #8f0075;">-</span>MMM<span style="color: #8f0075;">-</span>yy hh:mm tt
<span style="color: #5317ac;">Send</span> <span style="color: #00538b;">%time%</span> <span style="color: #8f0075;">~</span> JO : {<span style="color: #0000c0;">Enter</span>}
<span style="color: #813e00;">Return</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org1bea9e7" class="outline-3">
<h3 id="org1bea9e7">Email Sign-Offs</h3>
<div class="outline-text-3" id="text-org1bea9e7">
<p>
Just wanted to make a note about these two as they're quite fun; they insert an email sign-off automatically; for example;
</p>

<div class="org-src-container">
<pre class="src src-text">Kind regards,
Warm regards,
Best regards,
Regards, 
Cheers,
All the best,
Many thanks,
Best wishes,
</pre>
</div>

<p>
As it keeps my emails feeling fresh. I also added a more silly one, for internal emails between colleagues, which works by picking a random word before 'regards'. For example:
</p>

<div class="org-src-container">
<pre class="src src-text">Confident
Supurb 
Interesting
Odd
Bemused
Transient
Obtuse 
Thought-provoking
Untested
Unproven
Unjust
Wobbly
Silly
Regards
Serious
Stern
Confusing
Critical
</pre>
</div>

<div class="org-src-container">
<pre class="src src-ahk">
<span style="color: #505050;">; </span><span style="color: #505050;">Insert a random, serious sign off</span>
<span style="color: #0000c0;">!F7</span>::
serious <span style="color: #8f0075;">:=</span> []
<span style="color: #5317ac;">lines</span> <span style="color: #8f0075;">:=</span> 0
<span style="color: #5317ac;">Loop</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Read</span><span style="color: #8f0075;">,</span> C:\cmd\ahk\res\serious<span style="color: #8f0075;">.</span>txt
{
        serious<span style="color: #8f0075;">.</span>Push(<span style="color: #00538b;">A_LoopReadLine</span>)
        <span style="color: #5317ac;">lines</span><span style="color: #8f0075;">++</span>
}
<span style="color: #5317ac;">Random</span><span style="color: #8f0075;">,</span> randum<span style="color: #8f0075;">,</span> 0<span style="color: #8f0075;">,</span> <span style="color: #00538b;">%lines%</span>
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> % serious[randum]
<span style="color: #813e00;">Return</span>

<span style="color: #505050;">; </span><span style="color: #505050;">Insert a random, non-serious sign off - X regards,</span>
<span style="color: #0000c0;">!F8</span>::
silly <span style="color: #8f0075;">:=</span> []
<span style="color: #5317ac;">lines</span> <span style="color: #8f0075;">:=</span> 0
<span style="color: #5317ac;">Loop</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Read</span><span style="color: #8f0075;">,</span> C:\cmd\ahk\res\silly<span style="color: #8f0075;">.</span>txt
{
        silly<span style="color: #8f0075;">.</span>Push(<span style="color: #00538b;">A_LoopReadLine</span>)
        <span style="color: #5317ac;">lines</span><span style="color: #8f0075;">++</span>
}
<span style="color: #5317ac;">Random</span><span style="color: #8f0075;">,</span> randum<span style="color: #8f0075;">,</span> 0<span style="color: #8f0075;">,</span> <span style="color: #00538b;">%lines%</span>
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> % silly[randum]
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> {<span style="color: #0000c0;">space</span>}regards<span style="color: #8f0075;">,</span>
<span style="color: #813e00;">Return</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orgbf8f42e" class="outline-3">
<h3 id="orgbf8f42e">LinkedIn</h3>
<div class="outline-text-3" id="text-orgbf8f42e">
<p>
LinkedIn has very silly message suggestions, in the opinion of almost everyone I've ever discussed this with&#x2026; so this picks some random messages I took from LinkedIn and sends them at random. The results of sending this are, funnily enough, very similar to how a LinkedIn auto-generated conversation seems&#x2026;
</p>

<div class="org-src-container">
<pre class="src src-ahk">
<span style="color: #505050;">; </span><span style="color: #505050;">Insert a random, LinkedIn Style Message</span>
<span style="color: #0000c0;">!F9</span>::
linkedin <span style="color: #8f0075;">:=</span> []
<span style="color: #5317ac;">lines</span> <span style="color: #8f0075;">:=</span> 0
<span style="color: #5317ac;">Loop</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Read</span><span style="color: #8f0075;">,</span> C:\cmd\ahk\res\linkedin<span style="color: #8f0075;">.</span>txt
{
        linkedin<span style="color: #8f0075;">.</span>Push(<span style="color: #00538b;">A_LoopReadLine</span>)
        <span style="color: #5317ac;">lines</span><span style="color: #8f0075;">++</span>
}
<span style="color: #5317ac;">Random</span><span style="color: #8f0075;">,</span> randum<span style="color: #8f0075;">,</span> 0<span style="color: #8f0075;">,</span> <span style="color: #00538b;">%lines%</span>
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> % linkedin[randum]
<span style="color: #813e00;">Return</span>

</pre>
</div>

<p>
These are the random messages I download:
</p>

<div class="org-src-container">
<pre class="src src-text">Indeed
It is
I think so
I'm not sure
Let me check
Haven't received it yet
I got it now
Okay, great
What about you? 
What do you do?
Working
At the office
In the office
Aha! 
Where? 
What's the location?
What is the location?
Sent
Please check
I'll call you
May I have your phone number
Thanks for sharing
Great news!
Hmm
Just kidding
&#128514;
&#128580;
&#129321;
&#128539;
&#128540;
Right now?
Experience?
Best regards
It's my pleasure
Hello
Are you there?
Where are you?
Okay
No problem
Take your time
No rush
Let me know how it goes
You can check now
What for?
I'm just asking
Nope
Congratulations
I'm fine
How's work?
How's life?
Thanks for asking
Please keep in touch
</pre>
</div>
</div>
</div>

<div id="outline-container-org6152e78" class="outline-3">
<h3 id="org6152e78">Lipsum</h3>
<div class="outline-text-3" id="text-org6152e78">
<p>
Okay, didn't think I'd annotate these quite as much here, but the last one that works similarly to the above (picking a piece of text out of a txt file) is this, to add some Lorem Ipsum text: 
</p>

<div class="org-src-container">
<pre class="src src-ahk">
<span style="color: #505050;">; </span><span style="color: #505050;">Insert Lipsum Text</span>
<span style="color: #0000c0;">!F10</span>::
<span style="color: #5317ac;">FileRead</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">Clipboard</span><span style="color: #8f0075;">,</span> res\lipsum<span style="color: #8f0075;">.</span>txt
<span style="color: #5317ac;">Clipwait</span><span style="color: #8f0075;">,</span> 1
<span style="color: #5317ac;">SendInput</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%clipboard%</span>
<span style="color: #00538b;">Clipboard</span><span style="color: #8f0075;">:=</span><span style="color: #2544bb;">""</span>
<span style="color: #813e00;">Return</span>

</pre>
</div>

<p>
And here is said file:
</p>

<div class="org-src-container">
<pre class="src src-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
</pre>
</div>
</div>
</div>

<div id="outline-container-org8c20920" class="outline-3">
<h3 id="org8c20920">Taskbar</h3>
<div class="outline-text-3" id="text-org8c20920">
<p>
I like to basically work without the presence of the taskbar on Windows 10. <b>But</b>, I don't like the auto-hide mode particularly, especially because if you receive a notification on any window, the damn bar pops up until you've clicked the notification (it does for Signal Desktop, anyway). So this little snippet (activated with <code>Alt + F12</code>) hids the task bar <i>properly</i>. I should say I ammended this code from <a href="https://www.autohotkey.com/board/topic/83594-how-to-hide-taskbar-with-hotkey/">here</a>.
</p>

<div class="org-src-container">
<pre class="src src-ahk">
<span style="color: #505050;">; </span><span style="color: #505050;">Alt+F12 to hide the taskbar entirely</span>
<span style="color: #0000c0;">!F12</span>::
<span style="color: #721045;">WinExist</span>(<span style="color: #2544bb;">"ahk_class Shell_TrayWnd"</span>)
Tog <span style="color: #8f0075;">:=</span> !Tog
<span style="color: #5317ac;">If</span> (Tog <span style="color: #8f0075;">=</span> <span style="color: #2544bb;">"1"</span>)
{
        <span style="color: #5317ac;">SetTimer</span><span style="color: #8f0075;">,</span> CheckForBar<span style="color: #8f0075;">,</span> 1000
<span style="color: #2a486a;">CheckForBar</span>:
        <span style="color: #5317ac;">If</span> <span style="color: #721045;">WinExist</span>(<span style="color: #2544bb;">"ahk_class Shell_TrayWnd"</span>)
        {
                <span style="color: #5317ac;">WinHide</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">ahk_class</span> Shell_TrayWnd
                <span style="color: #5317ac;">WinHide</span><span style="color: #8f0075;">,</span> Start <span style="color: #5317ac;">ahk_class</span> <span style="color: #5317ac;">Button</span>
        }
        <span style="color: #813e00;">Return</span>
}
<span style="color: #5317ac;">Else</span>
{
        <span style="color: #5317ac;">SetTimer</span><span style="color: #8f0075;">,</span> CheckForBar<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Off</span>
        <span style="color: #5317ac;">WinShow</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">ahk_class</span> Shell_TrayWnd
        <span style="color: #5317ac;">WinShow</span><span style="color: #8f0075;">,</span> Start <span style="color: #5317ac;">ahk_class</span> <span style="color: #5317ac;">Button</span>
}
<span style="color: #813e00;">Return</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org5df488f" class="outline-3">
<h3 id="org5df488f">Custom Start + E</h3>
<div class="outline-text-3" id="text-org5df488f">
<p>
A pretty commonly known Windows Shortcut is <code>Win + e</code>, which opens a new <i>explorer.exe</i> window. But it's a bit limited, in my opinion, being that you only open to your 'Recent Places' folder/view. This adds the functionality to be able to open a range of locations, with <code>Alt + e</code> instead. A GUI is created so that you can see the options: 
</p>

<div class="org-src-container">
<pre class="src src-ahk">
<span style="color: #721045;">emodeoff</span>()
{
        <span style="color: #5317ac;">Hotkey</span><span style="color: #8f0075;">,</span> c<span style="color: #8f0075;">,</span> C<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Off</span>
        <span style="color: #5317ac;">Hotkey</span><span style="color: #8f0075;">,</span> w<span style="color: #8f0075;">,</span> W<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Off</span>
        <span style="color: #5317ac;">Hotkey</span><span style="color: #8f0075;">,</span> j<span style="color: #8f0075;">,</span> J<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Off</span>
        <span style="color: #5317ac;">Hotkey</span><span style="color: #8f0075;">,</span> p<span style="color: #8f0075;">,</span> P<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Off</span>
        <span style="color: #5317ac;">Hotkey</span><span style="color: #8f0075;">,</span> s<span style="color: #8f0075;">,</span> S<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Off</span>
        <span style="color: #5317ac;">Hotkey</span><span style="color: #8f0075;">,</span> <span style="color: #0000c0;">Esc</span><span style="color: #8f0075;">,</span> EModeEscape<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Off</span>

        <span style="color: #5317ac;">Gui</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Destroy</span>
}
<span style="color: #0000c0;">!e</span>::
<span style="color: #5317ac;">Gui</span><span style="color: #8f0075;">,</span> <span style="color: #8f0075;">-</span><span style="color: #5317ac;">Caption</span>
<span style="color: #5317ac;">Gui</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Margin</span><span style="color: #8f0075;">,</span> 100<span style="color: #8f0075;">,</span> 30
<span style="color: #5317ac;">Gui</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Font</span><span style="color: #8f0075;">,</span> s12<span style="color: #8f0075;">,</span> Segoe UI
<span style="color: #5317ac;">Gui</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Add</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Text</span><span style="color: #8f0075;">,,</span> <span style="color: #0000c0;">Alt</span><span style="color: #8f0075;">+</span>E locations you can open (bindings below):
<span style="color: #5317ac;">Gui</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Font</span><span style="color: #8f0075;">,</span> s10<span style="color: #8f0075;">,</span> Consolas
<span style="color: #5317ac;">Gui</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Add</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Text</span><span style="color: #8f0075;">,,</span> <span style="color: #8f0075;">-</span> binding:    C   <span style="color: #8f0075;">=</span>     C:\Users\<span style="color: #00538b;">%A_UserName%</span>\
<span style="color: #5317ac;">Gui</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Add</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Text</span><span style="color: #8f0075;">,,</span> <span style="color: #8f0075;">-</span> binding:    W   <span style="color: #8f0075;">=</span>     C:\Users\<span style="color: #00538b;">%A_UserName%</span>\Documents\Website\
<span style="color: #5317ac;">Gui</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Add</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Text</span><span style="color: #8f0075;">,,</span> <span style="color: #8f0075;">-</span> binding:    J   <span style="color: #8f0075;">=</span>     J:\TSD\
<span style="color: #5317ac;">Gui</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Add</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Text</span><span style="color: #8f0075;">,,</span> <span style="color: #8f0075;">-</span> binding:    P   <span style="color: #8f0075;">=</span>     P:\Marketing Images\
<span style="color: #5317ac;">Gui</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Add</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Text</span><span style="color: #8f0075;">,,</span> <span style="color: #8f0075;">-</span> binding:    S   <span style="color: #8f0075;">=</span>     S:\
<span style="color: #5317ac;">Gui</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Show</span>
<span style="color: #5317ac;">Hotkey</span><span style="color: #8f0075;">,</span> c<span style="color: #8f0075;">,</span> C<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">On</span>
<span style="color: #5317ac;">Hotkey</span><span style="color: #8f0075;">,</span> w<span style="color: #8f0075;">,</span> W<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">On</span>
<span style="color: #5317ac;">Hotkey</span><span style="color: #8f0075;">,</span> j<span style="color: #8f0075;">,</span> J<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">On</span>
<span style="color: #5317ac;">Hotkey</span><span style="color: #8f0075;">,</span> p<span style="color: #8f0075;">,</span> P<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">On</span>
<span style="color: #5317ac;">Hotkey</span><span style="color: #8f0075;">,</span> s<span style="color: #8f0075;">,</span> S<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">On</span>
<span style="color: #5317ac;">Hotkey</span><span style="color: #8f0075;">,</span> <span style="color: #0000c0;">Esc</span><span style="color: #8f0075;">,</span> EModeEscape<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">On</span>
<span style="color: #813e00;">Return</span>
<span style="color: #2a486a;">C</span>:
        <span style="color: #5317ac;">Run</span><span style="color: #8f0075;">,</span> C:\Users\<span style="color: #00538b;">%A_UserName%</span>\
        emodeoff()
        <span style="color: #813e00;">Return</span>
<span style="color: #2a486a;">W</span>:
        <span style="color: #5317ac;">Run</span><span style="color: #8f0075;">,</span> C:\Users\<span style="color: #00538b;">%A_UserName%</span>\Documents\Website
        emodeoff()
        <span style="color: #813e00;">Return</span>
<span style="color: #2a486a;">J</span>:
        <span style="color: #5317ac;">Run</span><span style="color: #8f0075;">,</span> J:\TSD\
        emodeoff()
        <span style="color: #813e00;">Return</span>
<span style="color: #2a486a;">P</span>:
        <span style="color: #5317ac;">Run</span><span style="color: #8f0075;">,</span> P:\
        emodeoff()
        <span style="color: #813e00;">Return</span>
<span style="color: #2a486a;">S</span>:
        <span style="color: #5317ac;">Run</span><span style="color: #8f0075;">,</span> S:\
        emodeoff()
        <span style="color: #813e00;">Return</span>
<span style="color: #2a486a;">Esc</span>:
<span style="color: #2a486a;">EModeEscape</span>:
        emodeoff()
        <span style="color: #813e00;">Return</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5516d7c" class="outline-3">
<h3 id="org5516d7c">Screen Refresher and Keyboard Locker</h3>
<div class="outline-text-3" id="text-org5516d7c">
<p>
This toggles a 'screen refresher'; a way to bypass policy enforced screensaver timeouts by sending RAlt every 15 seconds: 
</p>

<div class="org-src-container">
<pre class="src src-ahk">
<span style="color: #0000c0;">!i</span>::
idltog <span style="color: #8f0075;">:=</span> !idltog
<span style="color: #5317ac;">If</span> (idltog <span style="color: #8f0075;">=</span> <span style="color: #2544bb;">"1"</span>)
{
        <span style="color: #5317ac;">TrayTip</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Screen</span> Refresher <span style="color: #5317ac;">On</span><span style="color: #8f0075;">,</span> The <span style="color: #5317ac;">screen</span> refresher has been <span style="color: #5317ac;">enabled</span><span style="color: #8f0075;">.</span>
        <span style="color: #5317ac;">SetTimer</span><span style="color: #8f0075;">,</span> KeepAlive<span style="color: #8f0075;">,</span> 15000
<span style="color: #2a486a;">KeepAlive</span>:
        <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> {<span style="color: #0000c0;">RAlt</span>}
        <span style="color: #813e00;">Return</span>
}
<span style="color: #5317ac;">Else</span>
{
        <span style="color: #5317ac;">TrayTip</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Screen</span> Refresher <span style="color: #5317ac;">Off</span><span style="color: #8f0075;">,</span> The <span style="color: #5317ac;">screen</span> refresher has been <span style="color: #5317ac;">disabled</span><span style="color: #8f0075;">.</span>
        <span style="color: #5317ac;">SetTimer</span><span style="color: #8f0075;">,</span> KeepAlive<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Off</span> <span style="color: #505050;">; </span><span style="color: #505050;">Turn off the timer</span>
}
<span style="color: #813e00;">Return</span>

</pre>
</div>

<p>
And this useful idea, that I found <a href="https://www.autohotkey.com/boards/viewtopic.php?t=33925">here</a>, works in tandem with the screen refresher; you can seamlessly lock all of the keys with this (activated and deactivated with <code>Alt + l</code>, by default:
</p>

<div class="org-src-container">
<pre class="src src-ahk">
<span style="color: #721045;">lock</span>(f<span style="color: #8f0075;">=</span>0<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">mouse</span><span style="color: #8f0075;">=</span>0<span style="color: #8f0075;">,</span> message<span style="color: #8f0075;">:=</span><span style="color: #2544bb;">"&#128274;"</span>) {
        <span style="color: #5317ac;">static</span> allkeys<span style="color: #8f0075;">,</span> ExcludeKeys<span style="color: #8f0075;">:=</span><span style="color: #2544bb;">"LButton,RButton"</span>
        <span style="color: #5317ac;">If</span> !allkeys
        {
                s<span style="color: #8f0075;">:=</span><span style="color: #2544bb;">"||NumpadEnter|Home|End|PgUp|PgDn|Left|Right|Up|Down|Del|Ins|"</span>
                <span style="color: #5317ac;">Loop</span><span style="color: #8f0075;">,</span> 254
                        k<span style="color: #8f0075;">:=</span><span style="color: #721045;">GetKeyName</span>(<span style="color: #5317ac;">Format</span>(<span style="color: #2544bb;">"VK{:0X}"</span><span style="color: #8f0075;">,</span><span style="color: #00538b;">A_Index</span>))
                <span style="color: #8f0075;">,</span> s<span style="color: #8f0075;">.=</span><span style="color: #721045;">InStr</span>(s<span style="color: #8f0075;">,</span> <span style="color: #2544bb;">"|"</span> k <span style="color: #2544bb;">"|"</span>) ? <span style="color: #2544bb;">""</span> : k <span style="color: #2544bb;">"|"</span>
                <span style="color: #5317ac;">For</span> k<span style="color: #8f0075;">,</span>v <span style="color: #5317ac;">in</span> {<span style="color: #5317ac;">Control</span>:<span style="color: #2544bb;">"Ctrl"</span><span style="color: #8f0075;">,</span><span style="color: #0000c0;">Escape</span>:<span style="color: #2544bb;">"Esc"</span>}
                s<span style="color: #8f0075;">:=</span>StrReplace(s<span style="color: #8f0075;">,</span> k<span style="color: #8f0075;">,</span> v)
                allkeys<span style="color: #8f0075;">:=</span><span style="color: #5317ac;">Trim</span>(s<span style="color: #8f0075;">,</span> <span style="color: #2544bb;">"|"</span>)
        }
        f<span style="color: #8f0075;">:=</span>f ? <span style="color: #2544bb;">"On"</span>:<span style="color: #2544bb;">"Off"</span>
        <span style="color: #5317ac;">If</span> <span style="color: #5317ac;">mouse</span>
                ExcludeKeys<span style="color: #8f0075;">:=</span><span style="color: #2544bb;">""</span>
        <span style="color: #5317ac;">For</span> k<span style="color: #8f0075;">,</span>v <span style="color: #5317ac;">in</span> StrSplit(allkeys<span style="color: #8f0075;">,</span><span style="color: #2544bb;">"|"</span>)
        <span style="color: #5317ac;">If</span> v <span style="color: #5317ac;">not</span> <span style="color: #5317ac;">in</span> <span style="color: #00538b;">%ExcludeKeys%</span>
                <span style="color: #5317ac;">Hotkey</span><span style="color: #8f0075;">,</span> <span style="color: #8f0075;">*</span><span style="color: #00538b;">%v%</span><span style="color: #8f0075;">,</span> Block_Input<span style="color: #8f0075;">,</span> <span style="color: #00538b;">%f%</span> <span style="color: #5317ac;">UseErrorLevel</span>
<span style="color: #2a486a;">Block_Input</span>:
        <span style="color: #5317ac;">If</span> message<span style="color: #8f0075;">!=</span>
                <span style="color: #5317ac;">Progress</span><span style="color: #8f0075;">,</span> B1 M fs30 ZH0 W50 CTB57EB7 CW0d455e<span style="color: #8f0075;">,</span> <span style="color: #00538b;">%message%</span>
        <span style="color: #5317ac;">If</span> (f<span style="color: #8f0075;">=</span><span style="color: #2544bb;">"off"</span>)
                <span style="color: #5317ac;">Progress</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Off</span>
        <span style="color: #813e00;">Return</span>
}
<span style="color: #0000c0;">!l</span>::
locktog <span style="color: #8f0075;">:=</span> !locktog
<span style="color: #5317ac;">If</span> (locktog <span style="color: #8f0075;">=</span> <span style="color: #2544bb;">"1"</span>)
{
        <span style="color: #5317ac;">lock</span>(1<span style="color: #8f0075;">,</span>1)
}
<span style="color: #5317ac;">Else</span>
{
        <span style="color: #5317ac;">lock</span>(0)
}
<span style="color: #813e00;">Return</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orged71511" class="outline-3">
<h3 id="orged71511">Printing</h3>
<div class="outline-text-3" id="text-orged71511">
<p>
I have two printing scripts. The first one is this simple (but extremely useful) script, which I like to have active on my work machine. It detects the presence of a window called <i>Store Details</i>, which is the name of the account picker on our big printer at work. It then just navigates to the number listed by your account (in my case, <a href="https://www.youtube.com/watch?v=4RV3RXMNGVs&amp;t=11s">I am also <b>not a number</b></a>, but I am and I'm number 60). 
</p>

<div class="org-src-container">
<pre class="src src-ahk"><span style="color: #a0132f;">#Persistent</span>
<span style="color: #5317ac;">FileRead</span><span style="color: #8f0075;">,</span> print_no<span style="color: #8f0075;">,</span> <span style="color: #00538b;">%A_ScriptDir%</span>\printer_number<span style="color: #8f0075;">.</span>txt
<span style="color: #5317ac;">SetTimer</span><span style="color: #8f0075;">,</span> CheckWin<span style="color: #8f0075;">,</span> 500
<span style="color: #2a486a;">CheckWin</span>:
        <span style="color: #5317ac;">IfWinActive</span><span style="color: #8f0075;">,</span> Store Details 
        {
                <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> {<span style="color: #5317ac;">Tab</span>}
                <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 500
                <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%print_no%</span>
                <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 500
                <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> {<span style="color: #0000c0;">Enter</span>}
        }
        <span style="color: #813e00;">Return</span>
</pre>
</div>

<p>
So that other people can use it easily at work, they can just put their number in a text file, like this:
</p>

<div class="org-src-container">
<pre class="src src-text">60
</pre>
</div>

<p>
The other printing script, <code>spooler</code>, is more complicated:
</p>

<ul class="org-ul">
<li>An AutoHotkey script (using a dependency called <code>Explorer_Get.ahk</code>) adds files from <i>Windows File Explorer</i> to a <code>printlist.txt</code> file</li>
<li><del>A VBScript then prints the files, but this part doesn't work very well</del></li>
<li>The AutoHotkey script calls a tiny <code>spooler.bat</code> one line Batch file, because running <i>Powershell</i> with arguments (required by this script, and because I don't have admin we need the <code>-ExecutionPolicy bypass</code> flag) doesn't seem to work directly from AutoHotkey</li>
<li>Finally, the Powershell script <code>spooler.ps1</code> runs and it prints the files and empties the print list</li>
</ul>

<p>
So firstly, here's the brilliant AutoHotkey script by Joshua A. Kinnison, <code>Explorer_Get.ahk</code>, which serves to get file information from a specific <i>Windows File Explorer</i> window.
</p>

<div class="org-src-container">
<pre class="src src-ahk"><span style="color: #505050;">/*</span>
<span style="color: #505050;">        Library for getting info from a specific explorer window (if window handle not specified, the currently active</span>
<span style="color: #505050;">        window will be used).  Requires AHK_L or similar.  Works with the desktop.  Does not currently work with save</span>
<span style="color: #505050;">        dialogs and such.</span>


<span style="color: #505050;">        Explorer_GetSelected(hwnd="")   - paths of target window's selected items</span>
<span style="color: #505050;">        Explorer_GetAll(hwnd="")        - paths of all items in the target window's folder</span>
<span style="color: #505050;">        Explorer_GetPath(hwnd="")       - path of target window's folder</span>

<span style="color: #505050;">        example:</span>
<span style="color: #505050;">                F1::</span>
<span style="color: #505050;">                        path := Explorer_GetPath()</span>
<span style="color: #505050;">                        all := Explorer_GetAll()</span>
<span style="color: #505050;">                        sel := Explorer_GetSelected()</span>
<span style="color: #505050;">                        MsgBox % path</span>
<span style="color: #505050;">                        MsgBox % all</span>
<span style="color: #505050;">                        MsgBox % sel</span>
<span style="color: #505050;">                return</span>

<span style="color: #505050;">        Joshua A. Kinnison</span>
<span style="color: #505050;">        2011-04-27, 16:12</span>
<span style="color: #505050;">*/</span>

<span style="color: #721045;">Explorer_GetPath</span>(hwnd<span style="color: #8f0075;">=</span><span style="color: #2544bb;">""</span>)
{
        <span style="color: #5317ac;">if</span> !(window <span style="color: #8f0075;">:=</span> Explorer_GetWindow(hwnd))
                <span style="color: #813e00;">return</span> <span style="color: #00538b;">ErrorLevel</span> <span style="color: #8f0075;">:=</span> <span style="color: #2544bb;">"ERROR"</span>
        <span style="color: #5317ac;">if</span> (window<span style="color: #8f0075;">=</span><span style="color: #2544bb;">"desktop"</span>)
                <span style="color: #813e00;">return</span> <span style="color: #00538b;">A_Desktop</span>
        path <span style="color: #8f0075;">:=</span> window<span style="color: #8f0075;">.</span>LocationURL
        path <span style="color: #8f0075;">:=</span> <span style="color: #721045;">RegExReplace</span>(path<span style="color: #8f0075;">,</span> <span style="color: #2544bb;">"ftp://.*@"</span><span style="color: #8f0075;">,</span><span style="color: #2544bb;">"ftp://"</span>)
        <span style="color: #5317ac;">StringReplace</span><span style="color: #8f0075;">,</span> path<span style="color: #8f0075;">,</span> path<span style="color: #8f0075;">,</span> file:<span style="color: #8f0075;">///</span>
        <span style="color: #5317ac;">StringReplace</span><span style="color: #8f0075;">,</span> path<span style="color: #8f0075;">,</span> path<span style="color: #8f0075;">,</span> <span style="color: #8f0075;">/,</span> \<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">All</span> 

        <span style="color: #505050;">; </span><span style="color: #505050;">thanks to polyethene</span>
        <span style="color: #5317ac;">Loop</span>
                <span style="color: #5317ac;">If</span> <span style="color: #721045;">RegExMatch</span>(path<span style="color: #8f0075;">,</span> <span style="color: #2544bb;">"i)(?&lt;=%)[\da-f]{1,2}"</span><span style="color: #8f0075;">,</span> hex)
                        <span style="color: #5317ac;">StringReplace</span><span style="color: #8f0075;">,</span> path<span style="color: #8f0075;">,</span> path<span style="color: #8f0075;">,</span> `%<span style="color: #00538b;">%hex%</span><span style="color: #8f0075;">,</span> % <span style="color: #5317ac;">Chr</span>(<span style="color: #2544bb;">"0x"</span> <span style="color: #8f0075;">.</span> hex)<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">All</span>
                <span style="color: #5317ac;">Else</span> <span style="color: #5317ac;">Break</span>
        <span style="color: #813e00;">return</span> path
}
<span style="color: #721045;">Explorer_GetAll</span>(hwnd<span style="color: #8f0075;">=</span><span style="color: #2544bb;">""</span>)
{
        <span style="color: #813e00;">return</span> Explorer_Get(hwnd)
}
<span style="color: #721045;">Explorer_GetSelected</span>(hwnd<span style="color: #8f0075;">=</span><span style="color: #2544bb;">""</span>)
{
        <span style="color: #813e00;">return</span> Explorer_Get(hwnd<span style="color: #8f0075;">,</span><span style="color: #00538b;">true</span>)
}

<span style="color: #721045;">Explorer_GetWindow</span>(hwnd<span style="color: #8f0075;">=</span><span style="color: #2544bb;">""</span>)
{
        <span style="color: #505050;">; </span><span style="color: #505050;">thanks to jethrow for some pointers here</span>
    <span style="color: #5317ac;">WinGet</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">process</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">processName</span><span style="color: #8f0075;">,</span> % <span style="color: #2544bb;">"ahk_id"</span> hwnd <span style="color: #8f0075;">:=</span> hwnd? hwnd:<span style="color: #721045;">WinExist</span>(<span style="color: #2544bb;">"A"</span>)
    <span style="color: #5317ac;">WinGetClass</span> class<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">ahk_id</span> <span style="color: #00538b;">%hwnd%</span>

        <span style="color: #5317ac;">if</span> (<span style="color: #5317ac;">process</span><span style="color: #8f0075;">!=</span><span style="color: #2544bb;">"explorer.exe"</span>)
                <span style="color: #813e00;">return</span>
        <span style="color: #5317ac;">if</span> (class <span style="color: #8f0075;">~=</span> <span style="color: #2544bb;">"(Cabinet|Explore)WClass"</span>)
        {
                <span style="color: #5317ac;">for</span> window <span style="color: #5317ac;">in</span> <span style="color: #721045;">ComObjCreate</span>(<span style="color: #2544bb;">"Shell.Application"</span>)<span style="color: #8f0075;">.</span>Windows
                        <span style="color: #5317ac;">if</span> (window<span style="color: #8f0075;">.</span>hwnd<span style="color: #8f0075;">==</span>hwnd)
                                <span style="color: #813e00;">return</span> window
        }
        <span style="color: #5317ac;">else</span> <span style="color: #5317ac;">if</span> (class <span style="color: #8f0075;">~=</span> <span style="color: #2544bb;">"Progman|WorkerW"</span>) 
                <span style="color: #813e00;">return</span> <span style="color: #2544bb;">"desktop"</span> <span style="color: #505050;">; </span><span style="color: #505050;">desktop found</span>
}
<span style="color: #721045;">Explorer_Get</span>(hwnd<span style="color: #8f0075;">=</span><span style="color: #2544bb;">""</span><span style="color: #8f0075;">,</span>selection<span style="color: #8f0075;">=</span><span style="color: #00538b;">false</span>)
{
        <span style="color: #5317ac;">if</span> !(window <span style="color: #8f0075;">:=</span> Explorer_GetWindow(hwnd))
                <span style="color: #813e00;">return</span> <span style="color: #00538b;">ErrorLevel</span> <span style="color: #8f0075;">:=</span> <span style="color: #2544bb;">"ERROR"</span>
        <span style="color: #5317ac;">if</span> (window<span style="color: #8f0075;">=</span><span style="color: #2544bb;">"desktop"</span>)
        {
                <span style="color: #5317ac;">ControlGet</span><span style="color: #8f0075;">,</span> hwWindow<span style="color: #8f0075;">,</span> HWND<span style="color: #8f0075;">,,</span> SysListView321<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">ahk_class</span> Progman
                <span style="color: #5317ac;">if</span> !hwWindow <span style="color: #505050;">; </span><span style="color: #505050;">#D mode</span>
                        <span style="color: #5317ac;">ControlGet</span><span style="color: #8f0075;">,</span> hwWindow<span style="color: #8f0075;">,</span> HWND<span style="color: #8f0075;">,,</span> SysListView321<span style="color: #8f0075;">,</span> A
                <span style="color: #5317ac;">ControlGet</span><span style="color: #8f0075;">,</span> files<span style="color: #8f0075;">,</span> <span style="color: #5317ac;">List</span><span style="color: #8f0075;">,</span> % ( selection ? <span style="color: #2544bb;">"Selected"</span>:<span style="color: #2544bb;">""</span>) <span style="color: #2544bb;">"Col1"</span><span style="color: #8f0075;">,,</span><span style="color: #5317ac;">ahk_id</span> <span style="color: #00538b;">%hwWindow%</span>
                base <span style="color: #8f0075;">:=</span> <span style="color: #721045;">SubStr</span>(<span style="color: #00538b;">A_Desktop</span><span style="color: #8f0075;">,</span>0<span style="color: #8f0075;">,</span>1)<span style="color: #8f0075;">==</span><span style="color: #2544bb;">"\"</span> ? <span style="color: #721045;">SubStr</span>(<span style="color: #00538b;">A_Desktop</span><span style="color: #8f0075;">,</span>1<span style="color: #8f0075;">,-</span>1) : <span style="color: #00538b;">A_Desktop</span>
                <span style="color: #5317ac;">Loop</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">Parse</span><span style="color: #8f0075;">,</span> files<span style="color: #8f0075;">,</span> `n<span style="color: #8f0075;">,</span> `r
                {
                        path <span style="color: #8f0075;">:=</span> base <span style="color: #2544bb;">"\"</span> <span style="color: #00538b;">A_LoopField</span>
                        <span style="color: #5317ac;">IfExist</span> <span style="color: #00538b;">%path%</span> <span style="color: #505050;">; </span><span style="color: #505050;">ignore special icons like Computer (at least for now)</span>
                                ret <span style="color: #8f0075;">.=</span> path <span style="color: #2544bb;">"`n"</span>
                }
        }
        <span style="color: #5317ac;">else</span>
        {
                <span style="color: #5317ac;">if</span> selection
                        collection <span style="color: #8f0075;">:=</span> window<span style="color: #8f0075;">.</span>document<span style="color: #8f0075;">.</span>SelectedItems
                <span style="color: #5317ac;">else</span>
                        collection <span style="color: #8f0075;">:=</span> window<span style="color: #8f0075;">.</span>document<span style="color: #8f0075;">.</span>Folder<span style="color: #8f0075;">.</span>Items
                <span style="color: #5317ac;">for</span> item <span style="color: #5317ac;">in</span> collection
                        ret <span style="color: #8f0075;">.=</span> item<span style="color: #8f0075;">.</span>path <span style="color: #2544bb;">"`n"</span>
        }
        <span style="color: #813e00;">return</span> <span style="color: #5317ac;">Trim</span>(ret<span style="color: #8f0075;">,</span><span style="color: #2544bb;">"`n"</span>)
}
</pre>
</div>

<p>
Next, here's my simple AutoHotkey script to add file paths to the <code>printlist.txt</code> file (<code>Ctrl + Shift + p</code>) and print the print list by calling <code>spooler.bat</code> (<code>Ctrl + Shift + o</code>).
</p>

<div class="org-src-container">
<pre class="src src-ahk"><span style="color: #a0132f;">#Include</span> C:\cmd\ahk\res\Explorer_Get<span style="color: #8f0075;">.</span>ahk

<span style="color: #0000c0;">^+p</span>:: 
sel <span style="color: #8f0075;">:=</span> Explorer_GetSelected()
<span style="color: #5317ac;">FileAppend</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%sel%</span>`n<span style="color: #8f0075;">,</span> C:\cmd\ahk\res\printlist<span style="color: #8f0075;">.</span>txt
<span style="color: #505050;">; </span><span style="color: #505050;">Let user know what's been added</span>
<span style="color: #5317ac;">FileRead</span><span style="color: #8f0075;">,</span> PLContent<span style="color: #8f0075;">,</span> C:\cmd\ahk\res\printlist<span style="color: #8f0075;">.</span>txt
selArray <span style="color: #8f0075;">:=</span> StrSplit(sel<span style="color: #8f0075;">,</span> <span style="color: #2544bb;">"\"</span>)
<span style="color: #5317ac;">MsgBox</span> % <span style="color: #2544bb;">"Added '"</span> selArray[selArray<span style="color: #8f0075;">.</span><span style="color: #5317ac;">Count</span>()] <span style="color: #2544bb;">"'.`n`nThe file printlist.txt currently contains:`n"</span> PLContent
<span style="color: #813e00;">Return</span>

<span style="color: #0000c0;">^+o</span>::
<span style="color: #5317ac;">FileRead</span><span style="color: #8f0075;">,</span> PLContent<span style="color: #8f0075;">,</span> C:\cmd\ahk\res\printlist<span style="color: #8f0075;">.</span>txt
<span style="color: #5317ac;">if</span> (PLContent <span style="color: #8f0075;">=</span> <span style="color: #2544bb;">""</span>) 
{
        <span style="color: #5317ac;">MsgBox</span><span style="color: #8f0075;">,</span> 0<span style="color: #8f0075;">,,</span> There <span style="color: #5317ac;">is</span> <span style="color: #5317ac;">no</span> content to print<span style="color: #8f0075;">.</span>
        <span style="color: #813e00;">Return</span>
}
<span style="color: #5317ac;">MsgBox</span><span style="color: #8f0075;">,</span> 4<span style="color: #8f0075;">,,</span> File Contents: `n<span style="color: #00538b;">%PLContent%</span>`nWould you like to print?
<span style="color: #5317ac;">IfMsgBox</span> <span style="color: #5317ac;">Yes</span> 
        <span style="color: #5317ac;">Run</span><span style="color: #8f0075;">,</span> <span style="color: #2544bb;">"C:\cmd\bin\spooler.bat"</span>
<span style="color: #813e00;">Return</span>
</pre>
</div>

<p>
Here's the one like Batch file to work around the problem of correctly calling the <i>Powershell</i> script directly from AutoHotkey.
</p>

<div class="org-src-container">
<pre class="src src-bat">@<span style="color: #8f0075;">echo</span> off
powershell.exe -<span style="color: #005a5f;">ExecutionPolicy</span> bypass -<span style="color: #005a5f;">NoLogo</span> -<span style="color: #005a5f;">File</span> <span style="color: #2544bb;">"C:\cmd\bin\spooler.ps1"</span>
</pre>
</div>

<p>
Finally, this is the Powershell script that sends the <code>printlist.txt</code> to the default printer through the default PDF viewer (because <code>Out-Printer</code> doesn't understand PDF files). It then kills the window and finishes by clearing the <code>printlist.txt</code> file.
</p>

<div class="org-src-container">
<pre class="src src-powershell"><span style="color: #721045;">Add-Type</span> <span style="color: #0000c0;">-AssemblyName</span> PresentationFramework

<span style="color: #505050;"># Files / Paths</span>
<span style="color: #00538b;">$spool_dir</span>      = <span style="color: #2544bb;">"C:\cmd\ahk\res"</span>
<span style="color: #00538b;">$print_path</span>     = <span style="color: #2544bb;">"$spool_dir\printlist.txt"</span>
<span style="color: #00538b;">$print_log_path</span> = <span style="color: #2544bb;">"$spool_dir\printlist_log.txt"</span>
<span style="color: #00538b;">$print_bkp_path</span> = <span style="color: #2544bb;">"$spool_dir\printlist_backup.txt"</span>

<span style="color: #505050;"># Loop through each line, sending to printer or catching</span>
<span style="color: #5317ac;">ForEach</span>(<span style="color: #00538b;">$print_line</span> <span style="color: #5317ac;">in</span> <span style="color: #721045;">Get-Content</span> <span style="color: #00538b;">$print_path</span>) {
    <span style="color: #5317ac;">Try</span> {
        <span style="color: #505050;"># Opens and Prints the File</span>
        <span style="color: #721045;">Start-Process</span> <span style="color: #0000c0;">-FilePath</span> <span style="color: #00538b;">$print_line</span> <span style="color: #0000c0;">-Verb</span> Print <span style="color: #0000c0;">-PassThru</span> | %{sleep 10;<span style="color: #8f0075;">$_</span>} | kill
    }
    <span style="color: #505050;"># Error Catching</span>
    <span style="color: #5317ac;">Catch</span> {
        <span style="color: #005a5f;">[System.Windows.MessageBox]</span>::Show(<span style="color: #2544bb;">"An error with the path `"$print_line`" has been logged in the log file."</span>,<span style="color: #2544bb;">"Spooler Error"</span>,<span style="color: #2544bb;">"OK"</span>,<span style="color: #2544bb;">"Error"</span>)
        <span style="color: #00538b;">$err_date</span> = <span style="color: #721045;">Get-Date</span>
        <span style="color: #00538b;">$err_str</span>  = <span style="color: #2544bb;">"Error occurred when spooling at $err_date for the file: $print_line`r`n"</span>
        <span style="color: #721045;">Add-Content</span> <span style="color: #0000c0;">-Path</span> <span style="color: #00538b;">$print_log_path</span> <span style="color: #0000c0;">-Value</span> <span style="color: #00538b;">$err_str</span>
    }
}
<span style="color: #505050;"># Backup the file</span>
<span style="color: #721045;">Copy-Item</span> <span style="color: #00538b;">$print_path</span> <span style="color: #0000c0;">-Destination</span> <span style="color: #00538b;">$print_bkp_path</span>
<span style="color: #721045;">Clear-Content</span> <span style="color: #0000c0;">-Path</span> <span style="color: #00538b;">$print_path</span>
</pre>
</div>

<p>
This also catches the errors and creates log files if there's something wrong.
</p>
</div>
</div>

<div id="outline-container-org796001a" class="outline-3">
<h3 id="org796001a">Fun Stuff</h3>
<div class="outline-text-3" id="text-org796001a">
<p>
This part is in a file of its own, because I only want it active on my home machine, and it <i>needs</i> to be separate really. It 'detects' when <a href="https://www.rocketleague.com">Rocket League</a> is open and runs <a href="https://bakkesplugins.com/">Bakkesmod</a> when it is. 
</p>

<div class="org-src-container">
<pre class="src src-ahk"><span style="color: #a0132f;">#Persistent</span>
<span style="color: #5317ac;">SetTimer</span><span style="color: #8f0075;">,</span> CheckForRL<span style="color: #8f0075;">,</span> 30000
<span style="color: #2a486a;">CheckForRL</span>:
        <span style="color: #5317ac;">if</span> <span style="color: #721045;">WinExist</span>(<span style="color: #2544bb;">"Rocket League"</span>) <span style="color: #5317ac;">and</span> !<span style="color: #721045;">WinExist</span>(<span style="color: #2544bb;">"ahk_exe BakkesMod.exe"</span>)
        {
                <span style="color: #5317ac;">Run</span><span style="color: #8f0075;">,</span> <span style="color: #2544bb;">"D:\Programs\Bakkesmod"</span>
        }
        <span style="color: #813e00;">Return</span>
</pre>
</div>

<p>
I use the word <i>'detect'</i> quite liberally here&#x2026;
</p>

<p>
Back to the main <code>general.ahk</code> file; this next bit is quite pointless, but a little bit of fun! It basically just toggles the NumLock, CapsLock, and ScrollLock keys, rhythmically, to create visual patterns. This is an attempt at something akin to the <a href="https://www.youtube.com/watch?v=jXq23Tq9FeU">Black Mirror intro sound effect sequence</a> (which is a bit of a reach, but it's a nice pattern, regardless): 
</p>

<div class="org-src-container">
<pre class="src src-ahk">
<span style="color: #0000c0;">$^#l</span>::
<span style="color: #5317ac;">SetStoreCapsLockMode</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">off</span>
a <span style="color: #8f0075;">:=</span> <span style="color: #2544bb;">"{NumLock}"</span>
b <span style="color: #8f0075;">:=</span> <span style="color: #2544bb;">"{CapsLock}"</span>
c <span style="color: #8f0075;">:=</span> <span style="color: #2544bb;">"{ScrollLock}"</span>
<span style="color: #5317ac;">SetNumLockState</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">off</span>
<span style="color: #5317ac;">SetCapsLockState</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">off</span>
<span style="color: #5317ac;">SetScrollLockState</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">off</span>
ql <span style="color: #8f0075;">:=</span> 1000
<span style="color: #5317ac;">Loop</span><span style="color: #8f0075;">,</span> 8
{
  <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
  <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%ql%</span>
  <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
  <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
  <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%ql%</span>
  <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
  <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%c%</span>
  <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%ql%</span>
  <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%c%</span>
  ql <span style="color: #8f0075;">:=</span> ql<span style="color: #8f0075;">/</span>2
}
<span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 200
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%c%</span>
<span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 50
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%c%</span>
<span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 100
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%c%</span>
<span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 50
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
<span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%c%</span>
<span style="color: #813e00;">Return</span>

</pre>
</div>

<p>
And this was created to try and recreate the rhythm of the <a href="https://www.youtube.com/watch?v=c7O91GDWGPU">William Tell Overture, Final</a>: 
</p>

<div class="org-src-container">
<pre class="src src-ahk"><span style="color: #0000c0;">$^#w</span>::
<span style="color: #5317ac;">SetStoreCapsLockMode</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">off</span>
a <span style="color: #8f0075;">:=</span> <span style="color: #2544bb;">"{NumLock}"</span>
b <span style="color: #8f0075;">:=</span> <span style="color: #2544bb;">"{CapsLock}"</span>
c <span style="color: #8f0075;">:=</span> <span style="color: #2544bb;">"{ScrollLock}"</span>
<span style="color: #5317ac;">SetNumLockState</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">off</span>
<span style="color: #5317ac;">SetCapsLockState</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">off</span>
<span style="color: #5317ac;">SetScrollLockState</span><span style="color: #8f0075;">,</span> <span style="color: #5317ac;">off</span>
<span style="color: #5317ac;">count</span> <span style="color: #8f0075;">:=</span> 1
<span style="color: #5317ac;">Loop</span><span style="color: #8f0075;">,</span> 3
{
  <span style="color: #5317ac;">Loop</span><span style="color: #8f0075;">,</span> 3
  {
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 100
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%c%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 60
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%c%</span>
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 60
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 60
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
  }
  <span style="color: #5317ac;">If</span> (<span style="color: #5317ac;">count</span> <span style="color: #8f0075;">==</span> 1)
  {
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 200
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%c%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 200
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%c%</span>
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 200
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
  }
  <span style="color: #5317ac;">Else</span> <span style="color: #5317ac;">If</span> (<span style="color: #5317ac;">count</span> <span style="color: #8f0075;">==</span> 2)
  {
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 200
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 200
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 200
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
  }
  <span style="color: #5317ac;">Else</span>
  {
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 200
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 200
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 200
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 100
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 100
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%c%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 800
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%c%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 200
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 200
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 400
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%c%</span>
    <span style="color: #5317ac;">Sleep</span><span style="color: #8f0075;">,</span> 400
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%a%</span>
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%b%</span>
    <span style="color: #5317ac;">Send</span><span style="color: #8f0075;">,</span> <span style="color: #00538b;">%c%</span>
  }
  <span style="color: #5317ac;">count</span> <span style="color: #8f0075;">:=</span> <span style="color: #5317ac;">count</span><span style="color: #8f0075;">+</span>1
}
<span style="color: #813e00;">Return</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgaf7bf3b" class="outline-2">
<h2 id="orgaf7bf3b">Cygwin</h2>
<div class="outline-text-2" id="text-orgaf7bf3b">
</div>
<div id="outline-container-orgf8e525c" class="outline-3">
<h3 id="orgf8e525c">About</h3>
<div class="outline-text-3" id="text-orgf8e525c">
<p>
I use the mintty Cygwin terminal emulator, through <a href="https://gitforwindows.org/">Git Bash</a> for Windows. This usually means I miss out on the latest and greatest features, sadly, and I don't have the package management resources that would normally come with Cygwin.
</p>

<p>
However, I do have a few files to set this up nicely. 
</p>
</div>
</div>

<div id="outline-container-org058c9db" class="outline-3">
<h3 id="org058c9db">Bashrc</h3>
<div class="outline-text-3" id="text-org058c9db">
<p>
Here's a minimal <code>.bashrc</code> file that I use on my Windows machines:
</p>

<div class="org-src-container">
<pre class="src src-sh">
<span style="color: #505050;"># </span><span style="color: #505050;">Aliases</span>
alias <span style="color: #00538b;">cls</span>=<span style="color: #2544bb;">"clear"</span>
alias <span style="color: #00538b;">grep</span>=<span style="color: #2544bb;">"grep --color=auto"</span>
alias <span style="color: #00538b;">ls</span>=<span style="color: #2544bb;">"ls --color=always"</span>
alias <span style="color: #00538b;">ll</span>=<span style="color: #2544bb;">'ls -alF'</span>
alias <span style="color: #00538b;">la</span>=<span style="color: #2544bb;">'ls -A'</span>
alias <span style="color: #00538b;">l</span>=<span style="color: #2544bb;">'ls -CF'</span>

<span style="color: #505050;"># </span><span style="color: #505050;">PS1</span>
<span style="color: #8f0075;">export</span> <span style="color: #00538b;">PS1</span>=<span style="color: #2544bb;">"  &#26862; @ \w &gt; \[$(tput sgr0)\]"</span>

<span style="color: #505050;"># </span><span style="color: #505050;">Shortcuts</span>
alias <span style="color: #00538b;">backup</span>=<span style="color: #2544bb;">"cp ~/.bashrc ~/.minttyrc /c/cmd/sh/."</span>
alias <span style="color: #00538b;">ga</span>=<span style="color: #2544bb;">"git pull --recurse-submodules; git add ."</span>
alias <span style="color: #00538b;">gui</span>=<span style="color: #2544bb;">"explorer ."</span>
alias <span style="color: #00538b;">dev</span>=<span style="color: #2544bb;">"cd /c/cmd/"</span>
alias <span style="color: #00538b;">home</span>=<span style="color: #2544bb;">"cd ~"</span>
alias <span style="color: #00538b;">uk</span>=<span style="color: #2544bb;">"cd ~/Documents/Website/2\)\ UK\ Site/"</span>
alias <span style="color: #00538b;">us</span>=<span style="color: #2544bb;">"cd ~/Documents/Website/3\)\ Export/US\ Site/"</span>
alias <span style="color: #00538b;">eu</span>=<span style="color: #2544bb;">"cd ~/Documents/Website/3\)\ Export/EU\ Site/"</span>
alias <span style="color: #00538b;">ca</span>=<span style="color: #2544bb;">"cd ~/Documents/Website/3\)\ Export/CA\ Site/"</span>
alias <span style="color: #00538b;">wip</span>=<span style="color: #2544bb;">"cd ~/Documents/Website/6\)\ Wordpressify/wp-content/themes/wessex/"</span>
alias <span style="color: #00538b;">gitwc</span>=<span style="color: #2544bb;">"~/gitwc.sh"</span>
alias <span style="color: #00538b;">php</span>=<span style="color: #2544bb;">"/c/MAMP/bin/php/php7.2.10/php.exe"</span>
alias <span style="color: #00538b;">ruby</span>=<span style="color: #2544bb;">"/c/MAMP/bin/ruby/bin/ruby.exe"</span>

<span style="color: #505050;"># </span><span style="color: #505050;">Path 0_0</span>
<span style="color: #8f0075;">export</span> <span style="color: #00538b;">PATH</span>=$<span style="color: #00538b;">PATH</span>:<span style="color: #2544bb;">"/c/cmd/sh/"</span>
<span style="color: #8f0075;">export</span> <span style="color: #00538b;">PATH</span>=$<span style="color: #00538b;">PATH</span>:<span style="color: #2544bb;">"$HOME/clock/bin/"</span>
<span style="color: #8f0075;">export</span> <span style="color: #00538b;">PATH</span>=$<span style="color: #00538b;">PATH</span>:<span style="color: #2544bb;">"/c/cmd/bin/"</span>
<span style="color: #8f0075;">export</span> <span style="color: #00538b;">PATH</span>=$<span style="color: #00538b;">PATH</span>:<span style="color: #2544bb;">"/c/cmd/bin/nvim/bin/"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org0815e32" class="outline-3">
<h3 id="org0815e32">Minttyrc</h3>
<div class="outline-text-3" id="text-org0815e32">
<p>
Here's my <code>.minttyrc</code> file:
</p>

<div class="org-src-container">
<pre class="src src-text">
# General
Transparency=low
CursorType=block
CursorBlinks=yes
Font=Anonymice NF
FontHeight=11
FontSmoothing=full
AllowBlinking=yes
BoldAsFont=yes
Printer=
Columns=166
Rows=45
Scrollbar=none
Padding=20
RowSpacing=5
FontWeight=400

# Dracula Colour Scheme
ForegroundColour=248,248,242
BackgroundColour=40,42,54
Black=0,0,0
BoldBlack=104,104,104
Red=255,85,85
BoldRed=255,110,103
Green=80,250,123
BoldGreen=90,247,142
Yellow=241,250,140
BoldYellow=244,249,157
Blue=202,169,250
BoldBlue=202,169,250
Magenta=255,121,198
BoldMagenta=255,146,208
Cyan=139,233,253
BoldCyan=154,237,254
White=191,191,191
BoldWhite=230,230,230

# Colour Scheme
# BackgroundColour=234,234,234
# ForegroundColour=41,41,41
# CursorColour=41,41,41
# Black=41,41,41
# BoldBlack=128,128,128
# Red=178,97,77
# BoldRed=211,164,152
# Green=77,178,97
# BoldGreen=152,211,164
# Yellow=158,178,77
# BoldYellow=199,211,152
# Blue=97,77,178
# BoldBlue=164,152,211
# Magenta=178,77,158
# BoldMagenta=211,152,199
# Cyan=77,158,178
# BoldCyan=152,199,211
# White=234,234,234
# BoldWhite=255,255,255

</pre>
</div>

<p>
I either use the commented out custom theme, which is light, or I use the dark Dracula theme to match my Emacs config and save my eyesight.
</p>
</div>
</div>

<div id="outline-container-org45c1d21" class="outline-3">
<h3 id="org45c1d21">Tidy Files</h3>
<div class="outline-text-3" id="text-org45c1d21">
<p>
I wrote this script in Ruby to tidy up some file names, after they've been mauled by Windows explorer.exe bulk renaming (e.g. <code>File (1).jpg</code>, <code>File (2).jpg</code>, etc.):
</p>

<div class="org-src-container">
<pre class="src src-ruby">
<span style="color: #505050;">#</span><span style="color: #505050;">!/c/MAMP/bin/ruby/bin/ruby.exe</span>

<span style="color: #5317ac;">def</span> <span style="color: #721045;">usage</span>
  puts
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"---------------------------------------------"</span>
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"Tidy: Makes Windows File Bulk Renaming Neater"</span>
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"---------------------------------------------"</span>
  puts
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"Designed to be used after bulk renaming files using"</span>
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"the Windows Explorer prompt."</span>
  puts
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"Arguments: "</span>
  puts
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"    -d         default; everything other than r"</span>
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"    -b         remove brackets from filename"</span>
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"    -e         normalize file extension"</span>
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"    -s         replace spaces with dashes"</span>
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"    -l         to lowercase"</span>
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"    -r         act recursively"</span>
  puts
  <span style="color: #8f0075;">exit</span>
<span style="color: #5317ac;">end</span>

<span style="color: #5317ac;">def</span> <span style="color: #721045;">tidy</span>
  current_dir = <span style="color: #005a5f;">Dir</span>.pwd
  b_flag = s_flag = l_flag = e_flag = <span style="color: #0000c0;">false</span>

  <span style="color: #505050;"># </span><span style="color: #505050;">Help</span>
  usage <span style="color: #5317ac;">if</span> <span style="color: #005a5f;">ARGV</span>.include? <span style="color: #2544bb;">"h"</span> <span style="color: #5317ac;">or</span> <span style="color: #005a5f;">ARGV</span>.empty?

  <span style="color: #505050;"># </span><span style="color: #505050;">Opts</span>
  puts
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"Changing files in "</span> + current_dir + <span style="color: #2544bb;">": "</span>
  <span style="color: #5317ac;">if</span> <span style="color: #005a5f;">ARGV</span>.include? <span style="color: #2544bb;">"d"</span>
    b_flag = s_flag = l_flag = e_flag = <span style="color: #0000c0;">true</span>
    working_dir =  <span style="color: #2544bb;">"*"</span>
  <span style="color: #5317ac;">else</span>
    b_flag = <span style="color: #0000c0;">true</span> <span style="color: #5317ac;">if</span> <span style="color: #005a5f;">ARGV</span>.include? <span style="color: #2544bb;">"b"</span> <span style="color: #505050;"># </span><span style="color: #505050;">Brackets</span>
    s_flag = <span style="color: #0000c0;">true</span> <span style="color: #5317ac;">if</span> <span style="color: #005a5f;">ARGV</span>.include? <span style="color: #2544bb;">"s"</span> <span style="color: #505050;"># </span><span style="color: #505050;">Dashes</span>
    l_flag = <span style="color: #0000c0;">true</span> <span style="color: #5317ac;">if</span> <span style="color: #005a5f;">ARGV</span>.include? <span style="color: #2544bb;">"l"</span> <span style="color: #505050;"># </span><span style="color: #505050;">Lowercase</span>
    e_flag = <span style="color: #0000c0;">true</span> <span style="color: #5317ac;">if</span> <span style="color: #005a5f;">ARGV</span>.include? <span style="color: #2544bb;">"e"</span> <span style="color: #505050;"># </span><span style="color: #505050;">Extension</span>
    <span style="color: #5317ac;">if</span> <span style="color: #005a5f;">ARGV</span>.include? <span style="color: #2544bb;">"r"</span>
      working_dir = <span style="color: #2544bb;">"**/*"</span> <span style="color: #505050;"># </span><span style="color: #505050;">Recursive</span>
    <span style="color: #5317ac;">else</span>
      working_dir = <span style="color: #2544bb;">"*"</span>
    <span style="color: #5317ac;">end</span>
  <span style="color: #5317ac;">end</span>
  puts

  <span style="color: #005a5f;">Dir</span>.glob(working_dir) <span style="color: #5317ac;">do</span> |current_file|
    <span style="color: #5317ac;">next</span> <span style="color: #5317ac;">if</span> current_file == <span style="color: #2544bb;">"."</span> <span style="color: #5317ac;">or</span> current_file == <span style="color: #2544bb;">".."</span> <span style="color: #5317ac;">or</span> <span style="color: #005a5f;">File</span>.directory?(current_file)
    file_rename = current_file

    <span style="color: #505050;"># </span><span style="color: #505050;">Brackets</span>
    file_rename = file_rename.gsub(<span style="color: #2544bb;">"("</span>, <span style="color: #2544bb;">""</span>).gsub(<span style="color: #2544bb;">")"</span>, <span style="color: #2544bb;">""</span>) <span style="color: #5317ac;">if</span> b_flag == <span style="color: #0000c0;">true</span>

    <span style="color: #505050;"># </span><span style="color: #505050;">Spaces</span>
    file_rename = file_rename.gsub(<span style="color: #2544bb;">" "</span>, <span style="color: #2544bb;">"-"</span>) <span style="color: #5317ac;">if</span> s_flag == <span style="color: #0000c0;">true</span>

    <span style="color: #505050;"># </span><span style="color: #505050;">Lowercase</span>
    file_rename = file_rename.downcase

    <span style="color: #505050;"># </span><span style="color: #505050;">Normalise File Extension</span>
    <span style="color: #5317ac;">if</span> e_flag == <span style="color: #0000c0;">true</span>
      <span style="color: #5317ac;">case</span> file_rename
      <span style="color: #5317ac;">when</span> <span style="color: #2544bb;">/\.jpeg/</span>
        file_rename = file_rename.gsub(<span style="color: #2544bb;">".jpeg"</span>, <span style="color: #2544bb;">".jpg"</span>)
      <span style="color: #5317ac;">when</span> <span style="color: #2544bb;">/\.cmd/</span>
        file_rename = file_rename.gsub(<span style="color: #2544bb;">".cmd"</span>, <span style="color: #2544bb;">".bat"</span>)
      <span style="color: #5317ac;">end</span>
    <span style="color: #5317ac;">end</span>

    <span style="color: #505050;"># </span><span style="color: #505050;">Rename, Output</span>
    <span style="color: #005a5f;">File</span>.rename(current_file, current_dir + <span style="color: #2544bb;">"/"</span> + file_rename)
    <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"    -&gt;  "</span> + current_file + <span style="color: #2544bb;">"  =&gt;  "</span> + file_rename
  <span style="color: #5317ac;">end</span>
  puts
<span style="color: #5317ac;">end</span>

tidy
<span style="color: #505050;"># </span><span style="color: #505050;">vi: ft=ruby</span>
</pre>
</div>

<p>
The shebang is weird, I mention this later on.
</p>
</div>
</div>

<div id="outline-container-org76e1a5c" class="outline-3">
<h3 id="org76e1a5c">Hack</h3>
<div class="outline-text-3" id="text-org76e1a5c">
<p>
A fun script to make it look like you're hacking:
</p>

<div class="org-src-container">
<pre class="src src-ruby">
<span style="color: #505050;">#</span><span style="color: #505050;">!/c/MAMP/bin/ruby/bin/ruby.exe</span>
<span style="color: #5317ac;">def</span> <span style="color: #721045;">finish_hack</span>
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"\nHack progress at 100%."</span>
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"\n\n   ---&gt;&gt;   HACK OF '"</span> + <span style="color: #005a5f;">ARGV</span>.join(<span style="color: #2544bb;">" "</span>).upcase + <span style="color: #2544bb;">"' COMPLETE.\n"</span>
  <span style="color: #8f0075;">exit</span>
<span style="color: #5317ac;">end</span>

<span style="color: #5317ac;">def</span> <span style="color: #721045;">main</span>
  na = [<span style="color: #2544bb;">"5"</span>,<span style="color: #2544bb;">"11"</span>,<span style="color: #2544bb;">"19"</span>,<span style="color: #2544bb;">"30"</span>,<span style="color: #2544bb;">"36"</span>,<span style="color: #2544bb;">"41"</span>,<span style="color: #2544bb;">"52"</span>,<span style="color: #2544bb;">"69"</span>,<span style="color: #2544bb;">"74"</span>,<span style="color: #2544bb;">"88"</span>,<span style="color: #2544bb;">"96"</span>,<span style="color: #2544bb;">"99"</span>,<span style="color: #2544bb;">"100"</span>]
  c = 0
  <span style="color: #8f0075;">loop</span> <span style="color: #5317ac;">do</span>
    <span style="color: #5317ac;">begin</span>
      <span style="color: #505050;"># </span><span style="color: #505050;">Having problems with running Ruby sleep on Cygwin</span>
      <span style="color: #8f0075;">sleep</span>(1.0/5.0)
      <span style="color: #505050;"># </span><span style="color: #505050;">This seems to work... but not very well at all.</span>
      <span style="color: #5317ac;">case</span> <span style="color: #8f0075;">rand</span>(8)
      <span style="color: #5317ac;">when</span> 0..5
        lc = <span style="color: #8f0075;">rand</span>(5..12)
        i = 0
        <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"\n"</span>
        <span style="color: #8f0075;">loop</span> <span style="color: #5317ac;">do</span>
          i = i + 1
          <span style="color: #8f0075;">puts</span> (<span style="color: #2544bb;">'!'</span>..<span style="color: #2544bb;">'~'</span>).to_a.shuffle[0,<span style="color: #8f0075;">rand</span>(7..200)].join
          <span style="color: #5317ac;">break</span> <span style="color: #5317ac;">if</span> i == lc
        <span style="color: #5317ac;">end</span>
      <span style="color: #5317ac;">when</span> 6
        <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"\nGenerating hack string...\n"</span>
      <span style="color: #5317ac;">when</span> 7
        finish_hack <span style="color: #5317ac;">if</span> na[c] == <span style="color: #2544bb;">"100"</span>
        <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"\nThe Hack Is Currently Ongoing."</span>
        <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"Please do not touch the keyboard until the time is right."</span>
        <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"\nHack progress at "</span> + na[c] + <span style="color: #2544bb;">"%.\n\n"</span>
        c = c + 1
      <span style="color: #5317ac;">end</span>
    <span style="color: #505050;"># </span><span style="color: #505050;">Handle Ctrl + C</span>
    <span style="color: #5317ac;">rescue</span> <span style="color: #005a5f;">Interrupt</span> =&gt; e
      finish_hack
    <span style="color: #5317ac;">end</span>
  <span style="color: #5317ac;">end</span>
<span style="color: #5317ac;">end</span>

main

<span style="color: #505050;"># </span><span style="color: #505050;">vi: ft=ruby</span>
</pre>
</div>

<p>
And this one is a lot better, but works on remote servers only (I have to use the Ruby stdlib on this machine):
</p>

<div class="org-src-container">
<pre class="src src-ruby">
<span style="color: #505050;">#</span><span style="color: #505050;">!/usr/bin/env ruby</span>

<span style="color: #8f0075;">require</span> <span style="color: #2544bb;">'colorize'</span>

<span style="color: #5317ac;">def</span> <span style="color: #721045;">finish_hack</span>
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"\nHack progress at 100%."</span>.red.underline
  <span style="color: #5317ac;">if</span> <span style="color: #005a5f;">ARGV</span>.empty?
    <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"\n\n   ---&gt;&gt;   HACK COMPLETE.\n"</span>.green.bold
  <span style="color: #5317ac;">else</span>
    <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"\n\n   ---&gt;&gt;   HACK OF "</span>.green.bold + <span style="color: #005a5f;">ARGV</span>.join(<span style="color: #2544bb;">" "</span>).upcase.light_green.italic + <span style="color: #2544bb;">" COMPLETE.\n"</span>.green.bold
  <span style="color: #5317ac;">end</span>
  <span style="color: #8f0075;">exit</span>
<span style="color: #5317ac;">end</span>

<span style="color: #5317ac;">def</span> <span style="color: #721045;">main</span>
  na = [<span style="color: #2544bb;">"5"</span>,<span style="color: #2544bb;">"11"</span>,<span style="color: #2544bb;">"19"</span>,<span style="color: #2544bb;">"30"</span>,<span style="color: #2544bb;">"36"</span>,<span style="color: #2544bb;">"41"</span>,<span style="color: #2544bb;">"52"</span>,<span style="color: #2544bb;">"69"</span>,<span style="color: #2544bb;">"74"</span>,<span style="color: #2544bb;">"88"</span>,<span style="color: #2544bb;">"96"</span>,<span style="color: #2544bb;">"99"</span>,<span style="color: #2544bb;">"100"</span>]
  colors = [<span style="color: #2544bb;">"green"</span>,<span style="color: #2544bb;">"cyan"</span>,<span style="color: #2544bb;">"light_blue"</span>,<span style="color: #2544bb;">"light_cyan"</span>,<span style="color: #2544bb;">"light_green"</span>]
  c = 0
  <span style="color: #8f0075;">loop</span> <span style="color: #5317ac;">do</span>
    <span style="color: #5317ac;">begin</span>
      <span style="color: #8f0075;">sleep</span>(1.0/5.0)
      <span style="color: #5317ac;">case</span> <span style="color: #8f0075;">rand</span>(0..7)
      <span style="color: #5317ac;">when</span> 0..5
        lc = <span style="color: #8f0075;">rand</span>(5..12)
        i = 0
        <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"\n"</span>
        <span style="color: #8f0075;">loop</span> <span style="color: #5317ac;">do</span>
          i = i + 1
          quickvar = (<span style="color: #2544bb;">'!'</span>..<span style="color: #2544bb;">'~'</span>).to_a.shuffle[0,<span style="color: #8f0075;">rand</span>(7..200)].join
          <span style="color: #8f0075;">puts</span> quickvar.to_s.send(colors.sample)
          <span style="color: #5317ac;">break</span> <span style="color: #5317ac;">if</span> i == lc
        <span style="color: #5317ac;">end</span>
      <span style="color: #5317ac;">when</span> 6
        <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"\nGenerating hack string...\n"</span>
      <span style="color: #5317ac;">when</span> 7
        finish_hack <span style="color: #5317ac;">if</span> na[c] == <span style="color: #2544bb;">"100"</span>
        <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"\nThe Hack Is Currently Ongoing."</span>.bold
        <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"Please do not touch the keyboard until the time is right."</span>.bold
        <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"\nHack progress at "</span>.bold + na[c].red.bold + <span style="color: #2544bb;">"%.\n\n"</span>.bold
        c = c + 1
      <span style="color: #5317ac;">end</span>
    <span style="color: #5317ac;">rescue</span> <span style="color: #005a5f;">Interrupt</span>
      finish_hack
    <span style="color: #5317ac;">end</span>
  <span style="color: #5317ac;">end</span>
<span style="color: #5317ac;">end</span>

main

</pre>
</div>
</div>
</div>

<div id="outline-container-orgfad02d2" class="outline-3">
<h3 id="orgfad02d2">MAMP Fix</h3>
<div class="outline-text-3" id="text-orgfad02d2">
<p>
My work machine has issues. One of them is with <a href="https://www.mamp.info/en/mamp/windows/">MAMP</a>, my web dev stack for Windows:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #505050;">#</span><span style="color: #505050;">!/bin/</span><span style="color: #5317ac;">sh</span>
rm /c/MAMP/db/mysql/mysql-bin*
</pre>
</div>

<p>
The issues I have occasionally seem to be fixed by resetting the MySQL-bin files.
</p>
</div>
</div>
</div>

<div id="outline-container-orgce28282" class="outline-2">
<h2 id="orgce28282">Wallpaper</h2>
<div class="outline-text-2" id="text-orgce28282">
</div>
<div id="outline-container-org2af5c00" class="outline-3">
<h3 id="org2af5c00">About</h3>
<div class="outline-text-3" id="text-org2af5c00">
<p>
I'm very happy with my Wallpaper handling scripts (a component of which you've already seen in [BROKEN LINK: windows.org#psrcps1&#x2014;powershell-config]). One thing that I <i>don't</i> like is that I've written them in a few different programming languages. This was because I was torn on exactly how they should work, initially.
</p>

<p>
Previously I needed a Git Submodule to link to my wallpaper files&#x2026; but thanks to this literate config, all I need now is to clone my wallpaper repo to the <code>c:\cmd\wallpapers\</code> folder! The command for Cygwin will be: 
</p>

<div class="org-src-container">
<pre class="src src-sh">git clone git@github.com:julianorchard/wallpapers.git /c/cmd/wallpaper/files/
</pre>
</div>
</div>
</div>

<div id="outline-container-orgda2a7ba" class="outline-3">
<h3 id="orgda2a7ba">Set The Wallpaper</h3>
<div class="outline-text-3" id="text-orgda2a7ba">
<p>
This Powershell file <b>sets</b> the wallpaper that has been chosen to live in the <code>\wallpapers</code> directory:
</p>

<div class="org-src-container">
<pre class="src src-powershell">
  <span style="color: #5317ac;">function</span> String-Line-One() 
  {
    <span style="color: #505050;"># Minutes To/Past</span>
      <span style="color: #00538b;">$minsInt</span> = <span style="color: #721045;">Get-Date</span> <span style="color: #0000c0;">-Format</span> <span style="color: #2544bb;">"mm"</span>
      <span style="color: #00538b;">$hourInt</span> = <span style="color: #721045;">Get-Date</span> <span style="color: #0000c0;">-Format</span> <span style="color: #2544bb;">"h."</span>

    <span style="color: #505050;"># Remove Trailing (.) in Hour</span>
      <span style="color: #00538b;">$hourInt</span> = <span style="color: #00538b;">$hourInt</span>.Substring(0, <span style="color: #00538b;">$hourInt</span>.Length - 1)
    <span style="color: #505050;"># Fixing Zero-Leading Minute</span>
      <span style="color: #00538b;">$m</span> = <span style="color: #00538b;">$minsInt</span>.ToCharArray()
      <span style="color: #00538b;">$m1</span> = <span style="color: #00538b;">$m</span>[0]
      <span style="color: #00538b;">$m2</span> = <span style="color: #00538b;">$m</span>[1]
      <span style="color: #5317ac;">if</span> ( <span style="color: #00538b;">$m1</span> <span style="color: #8f0075;">-eq</span> <span style="color: #2544bb;">"0"</span> ) { <span style="color: #00538b;">$minsInt</span> = <span style="color: #00538b;">$m2</span>.ToString() }

    <span style="color: #505050;"># Past/To The Hour/Next</span>
      <span style="color: #5317ac;">if</span> (<span style="color: #005a5f;">[int]</span><span style="color: #00538b;">$minsInt</span> <span style="color: #8f0075;">-lt</span> 35) 
      {
        <span style="color: #00538b;">$toOrPast</span> = <span style="color: #2544bb;">"Past"</span>
      }
      <span style="color: #5317ac;">else</span> 
      {
        <span style="color: #00538b;">$toOrPast</span> = <span style="color: #2544bb;">"To"</span>
        <span style="color: #00538b;">$minsInt</span> = 60 - <span style="color: #00538b;">$minsInt</span>
        <span style="color: #00538b;">$hourInt</span> = <span style="color: #005a5f;">[int]</span><span style="color: #00538b;">$hourInt</span> + 1
      }

    <span style="color: #505050;"># Make It Readable</span>
      <span style="color: #00538b;">$currentMinutes</span> = <span style="color: #721045;">Readable-Numbers</span>(<span style="color: #00538b;">$minsInt</span>)
      <span style="color: #00538b;">$currentHour</span> = <span style="color: #721045;">Readable-Numbers</span>(<span style="color: #00538b;">$hourInt</span>)
      <span style="color: #5317ac;">switch</span> ( <span style="color: #00538b;">$currentMinutes</span> )
      {
        <span style="color: #2544bb;">"One"</span> { <span style="color: #00538b;">$minType</span> = <span style="color: #2544bb;">" Minute"</span> }
        <span style="color: #5317ac;">default</span> { <span style="color: #00538b;">$minType</span> = <span style="color: #2544bb;">" Minutes"</span> }
      }
      <span style="color: #5317ac;">switch</span> ( <span style="color: #00538b;">$currentMinutes</span> ) 
      {
        <span style="color: #2544bb;">"Fifteen"</span> { 
          <span style="color: #00538b;">$currentMinutes</span> = <span style="color: #2544bb;">"Quarter"</span> 
          <span style="color: #00538b;">$minType</span> = <span style="color: #2544bb;">""</span>
        }
        <span style="color: #2544bb;">"Thirty"</span> { 
          <span style="color: #00538b;">$currentMinutes</span> = <span style="color: #2544bb;">"Half"</span> 
          <span style="color: #00538b;">$minType</span> = <span style="color: #2544bb;">""</span>
        }
      }
      <span style="color: #5317ac;">if</span> ( <span style="color: #00538b;">$currentHour</span> <span style="color: #8f0075;">-eq</span> <span style="color: #2544bb;">"Thirteen"</span> )
      {
        <span style="color: #00538b;">$currentHour</span> = <span style="color: #2544bb;">"One"</span>
      }
      <span style="color: #5317ac;">if</span> ( <span style="color: #00538b;">$currentMinutes</span> <span style="color: #8f0075;">-eq</span> <span style="color: #2544bb;">"Zero"</span> ) 
      {
        <span style="color: #5317ac;">return</span> <span style="color: #2544bb;">"It's $currentHour O'Clock"</span>
      } 
      <span style="color: #5317ac;">else</span> 
      {
        <span style="color: #5317ac;">return</span> <span style="color: #2544bb;">"It's $currentMinutes$minType $toOrPast $currentHour"</span>
      }
  }

  <span style="color: #5317ac;">function</span> String-Line-Two
  {
  <span style="color: #505050;"># Morning/Afternoon/Evening</span>
    <span style="color: #5317ac;">if</span> ((<span style="color: #721045;">Get-Date</span> <span style="color: #0000c0;">-Format</span> <span style="color: #2544bb;">"tt"</span>) <span style="color: #8f0075;">-eq</span> <span style="color: #2544bb;">"AM"</span>) 
    {
      <span style="color: #00538b;">$amOrPm</span> = <span style="color: #2544bb;">"morning"</span>
    }
    <span style="color: #5317ac;">else</span> 
    {
      <span style="color: #00538b;">$amOrPm</span> = <span style="color: #2544bb;">"afternoon"</span>
    }
  <span style="color: #505050;"># Day (getting 'th/nd/etc')</span>
    <span style="color: #00538b;">$dayAndMonth</span> = (<span style="color: #721045;">Get-Date</span> <span style="color: #0000c0;">-Format</span> <span style="color: #2544bb;">"M"</span>).ToString() <span style="color: #8f0075;">-Split</span> <span style="color: #2544bb;">" "</span>
    <span style="color: #00538b;">$day</span> = <span style="color: #00538b;">$dayAndMonth</span>[0]
    <span style="color: #00538b;">$dayEnd</span> = <span style="color: #5317ac;">switch</span> <span style="color: #8f0075;">-Regex</span> (<span style="color: #00538b;">$day</span>) 
    {
      {@(<span style="color: #2544bb;">"3"</span>, <span style="color: #2544bb;">"23"</span>) <span style="color: #8f0075;">-contains</span> <span style="color: #8f0075;">$_</span>} { <span style="color: #2544bb;">"rd"</span> }
      {@(<span style="color: #2544bb;">"2"</span>, <span style="color: #2544bb;">"22"</span>) <span style="color: #8f0075;">-contains</span> <span style="color: #8f0075;">$_</span>} { <span style="color: #2544bb;">"nd"</span> }
      {@(<span style="color: #2544bb;">"1"</span>, <span style="color: #2544bb;">"21"</span>, <span style="color: #2544bb;">"31"</span>) <span style="color: #8f0075;">-contains</span> <span style="color: #8f0075;">$_</span>} { <span style="color: #2544bb;">"st"</span> }
      <span style="color: #5317ac;">default</span> { <span style="color: #2544bb;">"th"</span> }
    }
  <span style="color: #505050;"># Month</span>
    <span style="color: #00538b;">$month</span> = <span style="color: #00538b;">$dayAndMonth</span>[1]
  <span style="color: #505050;"># Day of the Week</span>
    <span style="color: #00538b;">$dayOfTheWeek</span> = <span style="color: #721045;">Get-Date</span> <span style="color: #0000c0;">-Format</span> <span style="color: #2544bb;">"dddd"</span>
  <span style="color: #505050;"># Year </span>
    <span style="color: #00538b;">$year</span> = <span style="color: #721045;">Get-Date</span> <span style="color: #0000c0;">-Format</span> <span style="color: #2544bb;">"yyyy"</span>

    <span style="color: #5317ac;">return</span> <span style="color: #2544bb;">"in the $amOrPm on $dayOfTheWeek the $day$dayEnd of $month, $year"</span>
  }


<span style="color: #5317ac;">while</span> (<span style="color: #8f0075;">$true</span>)
{
<span style="color: #505050;"># Wallpaper Location (Could Be Randomized Eventually...)</span>
  <span style="color: #00538b;">$paperIn</span> = <span style="color: #2544bb;">"C:\cmd\wallpapers\current.jpg"</span>
  <span style="color: #00538b;">$paperOut</span> = <span style="color: #2544bb;">"C:\cmd\wallpapers\current.bmp"</span>

<span style="color: #505050;"># -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-</span>
<span style="color: #505050;"># CALL/CATCH STRING 1</span>
  <span style="color: #5317ac;">try</span>
  {
    <span style="color: #00538b;">$strLineOne</span> = String-Line-One
  }
  <span style="color: #5317ac;">catch</span> 
  {
    <span style="color: #00538b;">$strLineOne</span> = <span style="color: #2544bb;">"Have a good day"</span>
  }
<span style="color: #505050;"># -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-</span>
<span style="color: #505050;"># CALL/CATCH STRING 2</span>
  <span style="color: #5317ac;">try</span> 
  {
    <span style="color: #00538b;">$strLineTwo</span> = String-Line-Two
  }
  <span style="color: #5317ac;">catch</span> 
  {
    <span style="color: #00538b;">$strLineTwo</span> = <span style="color: #2544bb;">"... and try to remember to fix this background at some point."</span>
  }
<span style="color: #505050;"># -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~- </span>
<span style="color: #505050;"># COLOURS</span>
  <span style="color: #5317ac;">try</span> 
  {
  <span style="color: #505050;"># Get Current and Saved Colours</span>
    <span style="color: #00538b;">$currentColor</span> = <span style="color: #721045;">Get-Content</span> <span style="color: #0000c0;">-Path</span> <span style="color: #2544bb;">"C:\cmd\wallpapers\bin\colours.txt"</span> <span style="color: #0000c0;">-TotalCount</span> 1
    <span style="color: #00538b;">$savedColor</span>   = <span style="color: #721045;">Get-Content</span> <span style="color: #0000c0;">-Path</span> <span style="color: #2544bb;">"C:\cmd\wallpapers\bin\colours-saved.txt"</span> <span style="color: #0000c0;">-TotalCount</span> 1
  <span style="color: #505050;"># Copy Current Colour to Saved Colour</span>
    <span style="color: #721045;">Copy-Item</span> <span style="color: #2544bb;">"C:\cmd\wallpapers\bin\colours.txt"</span> <span style="color: #0000c0;">-Destination</span> <span style="color: #2544bb;">"C:\cmd\wallpapers\bin\colours-saved.txt"</span>
  }
  <span style="color: #5317ac;">catch</span> 
  { 
    <span style="color: #00538b;">$currentColor</span> = <span style="color: #2544bb;">"#FFF"</span> 
  }
<span style="color: #505050;"># -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-</span>
<span style="color: #505050;"># ImageMagick Set Wallpaper</span>
<span style="color: #505050;"># if ($currentcolor -ne $savedcolor) # -and (check text) TESTING</span>
    <span style="color: #00538b;">$arguments</span> = <span style="color: #2544bb;">'convert'</span>,<span style="color: #2544bb;">"$paperIn"</span>,<span style="color: #2544bb;">'-pointsize'</span>,<span style="color: #2544bb;">'60'</span>,<span style="color: #2544bb;">'-stroke'</span>,<span style="color: #2544bb;">'#222'</span>,<span style="color: #2544bb;">'-strokewidth'</span>,<span style="color: #2544bb;">'1.5'</span>,<span style="color: #2544bb;">'-fill'</span>,<span style="color: #00538b;">$currentColor</span>,<span style="color: #2544bb;">'-gravity'</span>,<span style="color: #2544bb;">'Center'</span>,<span style="color: #2544bb;">'-font'</span>,<span style="color: #2544bb;">'Times-New-Roman-Bold'</span>,<span style="color: #2544bb;">'-annotate'</span>,<span style="color: #2544bb;">'+0-260'</span>,<span style="color: #2544bb;">"$strLineOne"</span>,<span style="color: #2544bb;">'-pointsize'</span>,<span style="color: #2544bb;">'30'</span>,<span style="color: #2544bb;">'-font'</span>,<span style="color: #2544bb;">'Times-New-Roman'</span>,<span style="color: #2544bb;">'-strokewidth'</span>,<span style="color: #2544bb;">'0.8'</span>,<span style="color: #2544bb;">'-annotate'</span>,<span style="color: #2544bb;">'+0-200'</span>,<span style="color: #2544bb;">"$strLineTwo"</span>,<span style="color: #00538b;">$paperOut</span>
    &amp; magick <span style="color: #00538b;">$arguments</span>

<span style="color: #505050;"># Set the Wallpaper</span>
  <span style="color: #721045;">Set-Wallpaper</span>(<span style="color: #00538b;">$paperOut</span>)
  <span style="color: #721045;">Start-Sleep</span> <span style="color: #0000c0;">-Seconds</span> 15
}

</pre>
</div>
</div>
</div>

<div id="outline-container-org572721d" class="outline-3">
<h3 id="org572721d">Wallpaper Choice</h3>
<div class="outline-text-3" id="text-org572721d">
<p>
This Shell script works at work, with my work screen resolution, to pick the file to use in the <code>\wallpaper</code> folder:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #505050;">#</span><span style="color: #505050;">!/bin/</span><span style="color: #5317ac;">bash</span>

<span style="color: #00538b;">colourstr</span>=$(magick convert $<span style="color: #00538b;">1</span> +dither -colors 1 -unique-colors txt:)

[[ <span style="color: #2544bb;">"$colourstr"</span> =~ (<span style="color: #2544bb;">\#</span>[0-9,a-f,A-F]{3,6}) ]] &amp;&amp; <span style="color: #8f0075;">echo</span> <span style="color: #2544bb;">"${BASH_REMATCH[1]}"</span> &gt;/c/cmd/wallpapers/bin/colours.txt || <span style="color: #8f0075;">echo</span> <span style="color: #2544bb;">"#000"</span>&gt;/c/cmd/wallpapers/bin/colours.txt

<span style="color: #505050;"># </span><span style="color: #505050;">Normalize Current.jpg to 1920x1080, 16:9, output to current.jpg</span>
magick convert $<span style="color: #00538b;">1</span> -gravity South -crop 16:9 -resize 1920x1080 +repage current.jpg 

</pre>
</div>

<p>
And this does the same at my home screen resolution: 
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #505050;">#</span><span style="color: #505050;">!/bin/</span><span style="color: #5317ac;">bash</span>

<span style="color: #00538b;">colourstr</span>=$(magick convert $<span style="color: #00538b;">1</span> +dither -colors 1 -unique-colors txt:)
[[ <span style="color: #2544bb;">"$colourstr"</span> =~ (<span style="color: #2544bb;">\#</span>[0-9,a-f,A-F]{3,6}) ]] &amp;&amp; <span style="color: #8f0075;">echo</span> <span style="color: #2544bb;">"${BASH_REMATCH[1]}"</span> &gt;/c/cmd/wallpapers/bin/colours.txt || <span style="color: #8f0075;">echo</span> <span style="color: #2544bb;">"#000"</span>&gt;/c/cmd/wallpapers/bin/colours.txt
magick convert $<span style="color: #00538b;">1</span> -gravity South -crop 16:9 -resize 3440x1440 +repage current.jpg 

</pre>
</div>
</div>
</div>

<div id="outline-container-orgeaa19c0" class="outline-3">
<h3 id="orgeaa19c0">Sort Wallpaper Files</h3>
<div class="outline-text-3" id="text-orgeaa19c0">
<p>
Finally, this one is a Ruby script that <b>sorts</b> the wallpapers by name of the folder they're in:
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #505050;">#</span><span style="color: #505050;">!/c/MAMP/bin/ruby/bin/ruby.exe</span>
</pre>
</div>

<p>
Right, weirdness to mention at the shebang here: I am basically forced to use this weird shebang because I've not got Ruby in my PATH on my work machine; obviously this should really be:
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #505050;">#</span><span style="color: #505050;">!/usr/bin/env ruby</span>
</pre>
</div>

<p>
But it's not: sad.
</p>

<div class="org-src-container">
<pre class="src src-ruby">
<span style="color: #5317ac;">def</span> <span style="color: #721045;">main</span>
  done_renaming = <span style="color: #0000c0;">true</span>
  <span style="color: #005a5f;">Dir</span>.glob(<span style="color: #2544bb;">"files/*"</span>) <span style="color: #5317ac;">do</span> |d|
    <span style="color: #5317ac;">next</span> <span style="color: #5317ac;">if</span> <span style="color: #005a5f;">File</span>.file?(d)
    dir_name = d.split(<span style="color: #2544bb;">"/"</span>)[1]
    <span style="color: #005a5f;">Dir</span>.glob(d + <span style="color: #2544bb;">"/*"</span>) <span style="color: #5317ac;">do</span> |f|
      <span style="color: #505050;"># </span><span style="color: #505050;">Skip if it's already an appropriate name</span>
      <span style="color: #505050;"># </span><span style="color: #505050;">or if it's a folder</span>
      <span style="color: #5317ac;">next</span>\
        <span style="color: #5317ac;">if</span> <span style="color: #005a5f;">File</span>.basename(f, <span style="color: #2544bb;">"-*"</span>).include? dir_name\
      <span style="color: #5317ac;">or</span> <span style="color: #005a5f;">File</span>.directory?(f)
      <span style="color: #505050;"># </span><span style="color: #505050;">Do the file renaming</span>
      <span style="color: #8f0075;">print</span> <span style="color: #2544bb;">"\nRenaming:    '"</span> + f + <span style="color: #2544bb;">"'   "</span>
      <span style="color: #505050;"># </span><span style="color: #505050;">Gets the number of files in the directory</span>
      f_num = <span style="color: #005a5f;">Dir</span>[<span style="color: #005a5f;">File</span>.join(d, <span style="color: #2544bb;">'*'</span>)].count { |file| <span style="color: #005a5f;">File</span>.file?(file) }
      <span style="color: #505050;"># </span><span style="color: #505050;">Paths and rename</span>
      original_path = <span style="color: #005a5f;">Dir</span>.pwd + <span style="color: #2544bb;">"/"</span> + f
      rename_path =  <span style="color: #005a5f;">Dir</span>.pwd + <span style="color: #2544bb;">"/"</span> + d + <span style="color: #2544bb;">"/"</span> + dir_name + <span style="color: #2544bb;">"-"</span> + f_num.to_s + <span style="color: #005a5f;">File</span>.extname(f)
      <span style="color: #505050;"># </span><span style="color: #505050;">Show Renamed Name</span>
      <span style="color: #8f0075;">print</span> <span style="color: #2544bb;">"'"</span> + d + <span style="color: #2544bb;">"/"</span> + dir_name + <span style="color: #2544bb;">"-"</span> + f_num.to_s + <span style="color: #005a5f;">File</span>.extname(f) + <span style="color: #2544bb;">"'\n"</span>
      <span style="color: #005a5f;">File</span>.rename(original_path, rename_path)
      done_renaming = <span style="color: #0000c0;">false</span> <span style="color: #505050;"># </span><span style="color: #505050;">We renamed something</span>
    <span style="color: #5317ac;">end</span>
  <span style="color: #5317ac;">end</span>
  <span style="color: #505050;"># </span><span style="color: #505050;">Feedback if no renaming done</span>
  <span style="color: #8f0075;">puts</span> <span style="color: #2544bb;">"Nothing to rename."</span> <span style="color: #5317ac;">if</span> done_renaming
<span style="color: #5317ac;">end</span>

main

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd4ba028" class="outline-2">
<h2 id="orgd4ba028">Hours</h2>
<div class="outline-text-2" id="text-orgd4ba028">
</div>
<div id="outline-container-orgdd041f6" class="outline-3">
<h3 id="orgdd041f6">About</h3>
<div class="outline-text-3" id="text-orgdd041f6">
<p>
I don't use this anymore; it's retired, sadly.
</p>

<p>
I enjoyed working on it when I did, and I got a nice version working with VBScript, which was no small task in my opinion. But I use org-mode now, so it's fallen into obsolescence.
</p>

<p>
I'm not sure if this even works. It's quite nice to see how far I've come though.  Here's a screenshot of it in action:
</p>


<div id="org33c245d" class="figure">
<p><img src="./src/windows-hours.png" alt="windows-hours.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org27ca5e7" class="outline-3">
<h3 id="org27ca5e7">Argument Parsing</h3>
<div class="outline-text-3" id="text-org27ca5e7">
<p>
I wrote the argument parsing bit with Batch, for some reason:
</p>

<div class="org-src-container">
<pre class="src src-bat">@<span style="color: #8f0075;">echo</span> off

<span style="color: #8f0075;">set</span> <span style="color: #00538b;">inOut</span>=%<span style="color: #00538b;">1</span>
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">inputTime</span>=%<span style="color: #00538b;">2</span>
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">inputDate</span>=%<span style="color: #00538b;">3</span>
<span style="color: #8f0075;">shift</span>


<span style="color: #5317ac;">if</span> [%<span style="color: #00538b;">inputTime</span>%] == [] ( 
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">inputTime</span>=empty
)
<span style="color: #5317ac;">if</span> [%<span style="color: #00538b;">inputDate</span>%] == [] (
<span style="color: #8f0075;">set</span> <span style="color: #00538b;">inputDate</span>=empty
)

<span style="color: #505050;">:: No Args</span>
<span style="color: #5317ac;">if</span> [%<span style="color: #00538b;">inOut</span>%] == [] (
CScript C:\<span style="color: #5317ac;">cmd</span>\hours\bin\check.vbs normal //<span style="color: #005a5f;">nologo</span> 
<span style="color: #5317ac;">exit</span> /<span style="color: #005a5f;">b</span>
)
<span style="color: #505050;">:: Verbose</span>
<span style="color: #5317ac;">if</span> %<span style="color: #00538b;">inOut</span>% == v ( 
CScript C:\<span style="color: #5317ac;">cmd</span>\hours\bin\check.vbs verbose //<span style="color: #005a5f;">nologo</span> 
<span style="color: #5317ac;">exit</span> /<span style="color: #005a5f;">b</span>
)
<span style="color: #505050;">:: Quiet</span>
<span style="color: #5317ac;">if</span> %<span style="color: #00538b;">inOut</span>% == q (
CScript C:\<span style="color: #5317ac;">cmd</span>\hours\bin\check.vbs quiet //<span style="color: #005a5f;">nologo</span>
)

<span style="color: #505050;">:: Call </span><span style="color: #0000c0;">clock.vbs</span><span style="color: #505050;"> ; in / out</span>
<span style="color: #5317ac;">if</span> %<span style="color: #00538b;">inOut</span>% == <span style="color: #5317ac;">in</span> ( 
CScript C:\<span style="color: #5317ac;">cmd</span>\hours\bin\clock.vbs <span style="color: #5317ac;">in</span> %<span style="color: #00538b;">inputTime</span>% %<span style="color: #00538b;">inputDate</span>% //<span style="color: #005a5f;">nologo</span> 
<span style="color: #5317ac;">exit</span> /<span style="color: #005a5f;">b</span>
)
<span style="color: #5317ac;">if</span> %<span style="color: #00538b;">inOut</span>% == out ( 
CScript C:\<span style="color: #5317ac;">cmd</span>\hours\bin\clock.vbs out %<span style="color: #00538b;">inputTime</span>% %<span style="color: #00538b;">inputDate</span>% //<span style="color: #005a5f;">nologo</span> 
<span style="color: #5317ac;">exit</span> /<span style="color: #005a5f;">b</span>
)    

<span style="color: #505050;">:: Call 'Fill'</span>
<span style="color: #5317ac;">if</span> %<span style="color: #00538b;">inOut</span>% == fill (
CScript C:\<span style="color: #5317ac;">cmd</span>\hours\bin\fill.vbs %<span style="color: #00538b;">inputTime</span>% //<span style="color: #005a5f;">nologo</span>
<span style="color: #5317ac;">exit</span> /<span style="color: #005a5f;">b</span>
<span style="color: #505050;">:: Although I'm passing 'input time' through, </span>
<span style="color: #505050;">:: this is really the 'date' that'll be put through</span>
)
</pre>
</div>

<p>
I believe I used a Batch file so I wouldn't have to deal with any CScript weirdness with VBScript, but I think if I were to redo it I'd probably just use a VBScript to do this, too.
</p>
</div>
</div>

<div id="outline-container-orgc0ed426" class="outline-3">
<h3 id="orgc0ed426">Clocking In / Out</h3>
<div class="outline-text-3" id="text-orgc0ed426">
<p>
I'm keeping this in its messy glory; it's a little bit nostalgic.
</p>

<div class="org-src-container">
<pre class="src src-vbscript">
' Clock.vbs         ~~ Julian Orchard [hello@julianorchard.co.uk]
'   This file handles the bulk of the writing
'   content to the file, check.vbs handles the
'   reading more than this.

' Loop through the log file, copying each line
' of the file, unless it's the line we want to change
' in which case we just replace that line with the new
' content and move on; then replace the file at the end
	Function AddTime(ByVal inOut, ByVal currentTime, ByVal searchDate)

	' Get File Objects
	  Set fso      = CreateObject("Scripting.FileSystemObject")
	  Set editFile = fso.OpenTextFile("C:\CMD\hours\log\log-temp.csv",2,True)
    Set readFile = fso.OpenTextFile("C:\CMD\hours\log\log.csv",1)

	' Loop Through File
	  Do While readFile.AtEndOfStream &lt;&gt; True

    ' Current Line To Array
      lineFull = readFile.ReadLine
	    lineArray = Split(lineFull, ",")
	    lineDate  = DateValue(lineArray(0))

    ' Found The Input Date (seachDate)
	    If lineDate = searchDate Then
	If inOut = "in" Then
      ' For Replacing In
	  WScript.Echo "Replacing 'in' time " &amp; lineArray (1) &amp; " with " &amp; currentTime &amp; "."
	  editFile.WriteLine lineArray(0) &amp; "," &amp; _
			     currentTime      &amp; "," &amp; _
			     lineArray(2)
	Else
      ' For Replacing Out
	  If lineArray(2) = "" Then
	    WScript.Echo "Adding 'out' time " &amp; currentTime &amp; "."
	  Else
	    WScript.Echo "Replacing 'out' time " &amp; lineArray (2) &amp; " with " &amp; currentTime &amp; "."
	  End If  
	  editFile.WriteLine lineArray(0) &amp; "," &amp; _
			     lineArray(1) &amp; "," &amp; _
			     currentTime
	End If
      Else
      ' If The Input Date Not Found, Just Copy The
      ' Line To The New File Without Changing It
	editFile.WriteLine lineFull
	    End If
	  Loop
	  editFile.Close
    readFile.Close

    ' Replace Log With Log-Temp
      fso.DeleteFile "C:\CMD\hours\log\log.csv", True
      fso.MoveFile   "C:\CMD\hours\log\log-temp.csv", "C:\CMD\hours\log\log.csv"
	End Function

' Call if Row not found by Find-Row; makes new row
  Function NewRow(ByVal inOut, ByVal currentTime, ByVal searchDate)
  ' 8 == Append File
    Set fso  = CreateObject("Scripting.FileSystemObject").OpenTextFile("C:\CMD\hours\log\log.csv",8,True)

  ' Write YYYY/mm/dd,hh:mm,hh:mm
    fso.WriteLine searchDate &amp; "," &amp; currentTime &amp; ","
    fso.close
    Set fso = Nothing
    WScript.Echo "New entry added, " &amp; searchDate &amp; " at " &amp; currentTime
  End Function

' This function finds whether the row is there
' or not... I think this could be combined with 
' the FindRow function, might improve this at some point
  Function FindRow(ByVal inOut, ByVal currentTime, ByVal searchDate)
    found = False

    Set fso  = CreateObject("Scripting.FileSystemObject")
	  Set logFile = fso.OpenTextFile("C:\CMD\hours\log\log.csv", 1)

  ' Get each line of file
	  Do While logFile.AtEndOfStream &lt;&gt; True

    ' Split line into array, comma delim
	    lineArray = Split(logFile.ReadLine, ",")
    ' Current date is the first of the array
	    lineDate  = DateValue(lineArray(0))

		' SEARCH --------------------------------------------------------
	    If lineDate = searchDate Then
	found = True
      ' IN -------------------------------------------------
	If inOut = "in" Then
	  ' Check if 'In' is populated
	  If lineArray(1) = "" Then
	     Call AddTime(inOut,currentTime,searchDate)
						 Exit Do
	  Else
	    ' Check if overWrite is requested
	      If OverWriteConfirmation(inOut) = "y" Then
		  Call AddTime(inOut,currentTime,searchDate)
									Exit Do
	      Else
									Exit Do
	      End If
	  End If
      ' OUT ------------------------------------------------
	Else
	  If lineArray(1) = "" Then
	  ' Error, trying to clock out when there is no clock in data
	    WScript.Echo "You cannot clock out when you haven't yet clocked in for the day."
	    WScript.Echo "Please enter a clock in time."
						Exit Do
	  ElseIf lineArray(2) = "" Then
	    Call AddTime(inOut,currentTime,searchDate)
						Exit Do
	  Else
	    ' Check if overwrite is requested
	      If OverWriteConfirmation(inOut) = "y" Then
		  Call AddTime(inOut,currentTime,searchDate)
									Exit Do
	      Else
		  WScript.Echo "Exiting..."
									Exit Do
	      End If
	  End If
	End If
	    End If
	  Loop

	  logFile.Close
    Set logFile = Nothing

    ' Row wasn't found
    If found = False And inOut = "in" Then
      WScript.Echo "Attempting to record a new day..."
      Call NewRow(inOut,currentTime,searchDate)
    Else
      WScript.Echo "Error, not clocked in for this date. You need to clock in before you clock out!"
    End If

	End Function

  Function OverWriteConfirmation(ByVal inOut)
    If inOut = "in" Then
      WScript.Echo "You have already clocked in today."
    Else
      WScript.Echo "You have already clocked out today."
    End If
    WScript.StdOut.Write "Would you like to overwrite your current time? (y/n) : "
  ' Return confirmation
    OverWriteConfirmation = WScript.StdIn.ReadLine
  End Function

' Handle arguments from cl.bat
      Set args = WScript.Arguments
  ' In/Out = args(0)
      If args(0) = "in" Then
	inOut = "in"
      Else 
	inOut = "out"
      End If
  ' Time = args(1)
      If Not args(1) = "empty" Then
	currentTime = args(1)
      Else 
	currentTime = FormatDateTime(Now,4)
      End If
  ' Date = args(2)
      If Not args(2) = "empty" Then
	searchDate = DateValue(args(2))
      Else 
	searchDate = Date
      End If

    Call FindRow(inOut,currentTime,searchDate)
		WScript.Echo "huh?"
		Set pog = WScript.CreateObject("WScript.Shell")
		pog.Run "cl.vbs quiet"
		Set pog = Nothing
		WScript.Echo "Lol?"

</pre>
</div>
</div>
</div>

<div id="outline-container-orgc441d88" class="outline-3">
<h3 id="orgc441d88">Checking Times</h3>
<div class="outline-text-3" id="text-orgc441d88">
<p>
Again, I'm going to leave this pretty much as is.
</p>

<div class="org-src-container">
<pre class="src src-vbscript">' Check.vbs    ~~ Julian Orchard [hello@julianorchard.co.uk]

'   Read log file and show how many
'   hours have been logged this current week

' Checks the log file to get the basic values to be
' used in all other outputs
  Function Initial
    Set logFile = CreateObject("Scripting.FileSystemObject").OpenTextFile("C:\CMD\hours\log\log.csv", 1)
    ' Start of this week: https://stackoverflow.com/questions/8884098/find-this-weeks-monday
	startOfThisWeek = DateAdd("d", -((Weekday(Date) + 7 - 2) Mod 7), Date)
	daysOfTheWeekCount = 0

			' Get each line of file
				Do While logFile.AtEndOfStream &lt;&gt; True

				' Split line into array, comma delim
						lineArray = Split(logFile.ReadLine, ",")
' Current date is the first of the array
						lineDate = DateValue(lineArray(0))
						If lineDate = startOfThisWeek Then
								daysOfTheWeekCount = 5
						End If

						If daysOfTheWeekCount &lt;&gt; 0 Then
							startTime = lineArray(1)

						' Check an end time exists, do not try and count day if not
							If lineArray(2) = "" Then
								WScript.Echo "Warning, you have not clocked out for " &amp; lineDate
							Else 
								endTime = lineArray(2)
								minutesWorked = DateDiff("n",TimeValue(startTime),TimeValue(endTime))
								minutesTotal = minutesTotal + minutesWorked
							End If
							daysOfTheWeekCount = daysOfTheWeekCount - 1
						End If
				Loop
			' Return Initial (Raw)
				Initial = minutesTotal
	' Close Log File
    logFile.Close
    Set logFile = Nothing
	End Function

	Function Simple(ByRef raw)
	' Progress Bar and Nice Output
			hoursTotal = raw/60
			barProgress = Round(hoursTotal)
			barFill = 40 - barProgress

		' Add spaces before the number to make it prettier
		' hoursTotal        of         39.5 hours, complete!
			If Len(Round(hoursTotal,1)) = 1 Then
				WScript.StdOut.Write vbNewLine &amp; "   "
			ElseIf Len(Round(hoursTotal,1)) = 2 Then
				WScript.StdOut.Write vbNewLine &amp; "  "
			ElseIf Len(Round(hoursTotal,1)) = 3 Then
				WScript.StdOut.Write vbNewLine &amp; " "
			Else
				WScript.StdOut.Write vbNewLine &amp; ""
			End If
			WScript.StdOut.Write vbNewLine &amp; Round(hoursTotal,1) &amp; "        of       39.5 hours, complete!"

		' Progress Bar Generation!
		' [###################-------]
			WScript.StdOut.Write vbNewLine &amp; "["
		' Pound symbol content
				For i = 1 To barProgress
					WScript.StdOut.Write "#"
				Next 
		' Dash symbol content
				For j = 1 To barFill
					WScript.StdOut.Write "-"
				Next
			WScript.StdOut.Write "]" &amp; vbNewLine
			Simple = hoursTotal
  End Function

	Function UpdateCMDRC(raw)
		hoursTotal = raw/60
	' Open
		Set cmdrcFile = CreateObject("Scripting.FileSystemObject").OpenTextFile("C:\cmd\hours\log\cmdrc.txt", 2, true)
	' Output
		cmdrcFile.WriteLine(Round(hoursTotal,1))
	' Close
		cmdrcFile.Close
		Set cmdrcFile = Nothing
	End Function

' Verbose feature not implemented yet
  Function Verbose
      WScript.Echo "The Verbose output feature is not yet working. Please try again later."
  End Function

Set args = WScript.Arguments
raw = Initial ' This is the total minutes worked
If args(0) = "normal" Then
	Call Simple(raw)
	Call UpdateCMDRC(raw)
ElseIf args(0) = "quiet" Then
' To be called by clock.vbs
' as a default, eventually
	Call UpdateCMDRC(raw)
Else
' Not doing anything, at the moment...
	Call UpdateCMDRC(raw)
End If

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org5a9aad9" class="outline-2">
<h2 id="org5a9aad9">Notes</h2>
<div class="outline-text-2" id="text-org5a9aad9">
<p>
There are some bits of code that I don't <i>need</i> in files. I never call them individually in any of the above scripts. Previously, I <i>did</i> need them in file form, but with this document, I can just note them down quickly here.
</p>

<p>
Get the Windows 10 user's full name, <a href="https://community.spiceworks.com/topic/949313-what-is-the-windows-variable-for-a-users-full-name-not-just-the-username">from here</a>:
</p>

<div class="org-src-container">
<pre class="src src-bat">@<span style="color: #8f0075;">echo</span> off
<span style="color: #5317ac;">for</span> /<span style="color: #005a5f;">f</span> <span style="color: #2544bb;">"tokens=2*"</span> %%<span style="color: #00538b;">a</span> <span style="color: #5317ac;">in</span> ('<span style="color: #8f0075;">net</span> user <span style="color: #2544bb;">"%Username%"</span> /<span style="color: #005a5f;">domain</span> ^| <span style="color: #8f0075;">find</span> /<span style="color: #005a5f;">i</span> <span style="color: #2544bb;">"Full Name"</span>') <span style="color: #5317ac;">do</span> <span style="color: #8f0075;">set</span> <span style="color: #00538b;">DisplayName</span>=%%<span style="color: #00538b;">b</span>
<span style="color: #8f0075;">echo</span> %<span style="color: #00538b;">DisplayName</span>%
</pre>
</div>

<p>
At one point, I used this to change all my folder icons. All the other icons, were treated as second class citizens and changed through the GUI, but the folders needed this script, for some reason (I can't remember why):
</p>

<div class="org-src-container">
<pre class="src src-bat">@<span style="color: #8f0075;">echo</span> off
<span style="color: #5317ac;">if</span> [%<span style="color: #00538b;">1]</span> == [] <span style="color: #5317ac;">goto</span>:eof
<span style="color: #8f0075;">echo</span> [.ShellClassInfo] &gt;%<span style="color: #00538b;">1\desktop.in</span>
<span style="color: #8f0075;">echo</span> IconResource=<span style="color: #2544bb;">"c:/FOLDER ICON PATH.ico"</span>,0 &gt;&gt;%<span style="color: #00538b;">1\desktop.in</span>
<span style="color: #8f0075;">move</span> %<span style="color: #00538b;">1\desktop.in</span> %<span style="color: #00538b;">1\desktop.ini</span>
<span style="color: #8f0075;">attrib</span> +S +H %<span style="color: #00538b;">1\desktop.ini</span>
<span style="color: #8f0075;">attrib</span> +R %<span style="color: #00538b;">1</span>
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Julian Orchard &lt;git@julianorchard.co.uk&gt;</p>
<p class="date">Created: 2022-10-06 Thu 10:20</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
